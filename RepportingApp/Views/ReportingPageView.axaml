<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:RepportingApp.ViewModels"
             xmlns:local="clr-namespace:Reporting.lib.enums;assembly=Reporting.lib"
             xmlns:li="using:LoadingIndicators.Avalonia"
             xmlns:components1="clr-namespace:RepportingApp.Views.Components"
             xmlns:taskCardDesign="clr-namespace:RepportingApp.Views.Components.TaskCardDesign"
             mc:Ignorable="d"   d:DesignWidth="1620" d:DesignHeight="900"
             x:Class="RepportingApp.Views.ReportingPageView"
             x:DataType="viewModels:ReportingPageViewModel">
    <Grid x:Name="MainGrid" Background="White" >
        <Border ZIndex="10000">
            <components1:ErrorIndicatorView DataContext="{Binding ErrorIndicator}" />
        </Border>
        <Border  ZIndex="10000"   IsVisible="{Binding IsLoading , Mode=TwoWay}">
            <li:LoadingIndicator VerticalAlignment="Center" HorizontalAlignment="Center" Width="50" Height="50" IsActive="{Binding IsLoading , Mode=TwoWay}"  Mode="Arcs" SpeedRatio="1.2"/>
        </Border>
        <Grid.ColumnDefinitions>
            <!-- Main content column -->
            <ColumnDefinition Width="*" /> 
            <!-- Side menu column, this will be adjusted dynamically in the code-behind -->
            <ColumnDefinition Width="0" /> <!-- Default width for menu column is 0 (collapsed) -->
        </Grid.ColumnDefinitions>
        
        <!-- Side Menu -->
        <Border Grid.Column="1"
                Background="White"
                IsVisible="{Binding IsMenuOpen}"
                Padding="10">
       
            <Border Padding="10"  Background="#eeeeee">
                <Grid RowDefinitions="*,Auto">
                     <StackPanel >
                        <DockPanel>
                            <TextBlock Text="Sittings" FontWeight="SemiBold" Foreground="#847577" FontSize="16" Margin="10" FontFamily="{StaticResource Roboto}"/>
                            <Button Content="save" HorizontalAlignment="Right" Background="#077187"  Command="{Binding SaveSettingsCommand}"  Foreground="{StaticResource MainWhite}"
                                    Width="100" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                    Cursor="Hand" />
                        </DockPanel>
                        <Border BorderBrush="#847577" BorderThickness="1" Margin="0,0,0,15"></Border>
                        
                    <Border Background="White"
                            Padding="9"
                            Margin="0,0,0,15">
                        <Grid ColumnDefinitions="*,10,*,10,*" >
                            <StackPanel DockPanel.Dock="Left">
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Thread</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">سيتم استخدام القيمة لتحديد عدد حسابات البريد الإلكتروني التي سيتم معالجتها في كل مرة.
                                                    مثال: إذا كان لديك 500 حساب بريد إلكتروني وقمت بتحديد 50، فإن النظام سيقسم 500/50 وسيعالج كل مرة مجموعة من 50 حسابًا.</TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>
                                        
                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        FontWeight="Light"
                                        Text="Thread"
                                        Foreground="{StaticResource Secondary}"/>
                                </StackPanel>
                               <TextBox
                                   Watermark="Ex : 5"
                                   Padding="5"
                                   FontFamily="{StaticResource Roboto}"
                                   HorizontalContentAlignment="Center"
                                   Text="{Binding ReportingSettingsValuesDisplay.Thread,Mode=TwoWay}"
                               >
                                   <TextBox.Styles>
                                       <Style Selector="TextBox:pressed /template/ Border">
                                           <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                       </Style>
                                       <Style Selector="TextBox:pointerover /template/ Border">
                                           <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                       </Style>
                                   </TextBox.Styles>
                               </TextBox>
                            </StackPanel>
                            
                            <StackPanel  Grid.Column="2" DockPanel.Dock="Left">
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                      
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Repetition</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">سيتم استخدام هذه القيمة لتحديد عدد المرات التي سيعيد فيها النظام تنفيذ العملية.

                                                    على سبيل المثال، إذا قمت بتعيينها على 2، فعند انتهاء العملية ستبدأ من جديد (سيتم التعامل مع حسابات البريد الإلكتروني التي فشلت خلال التشغيل الأول بطريقة مختلفة).</TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>

                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        Foreground="{StaticResource Secondary}"
                                        FontWeight="SemiLight"
                                        Text="Repeat"/>
                                </StackPanel>
                                <TextBox 
                                    Watermark="Ex : 2"
                                    Padding="5"
                                    FontFamily="{StaticResource Roboto}"
                                    HorizontalContentAlignment="Center"
                                    BorderThickness="1"
                                    BorderBrush="{StaticResource Primary}"
                                    Text="{Binding ReportingSettingsValuesDisplay.Repetition,Mode=TwoWay}"
                                >
                                    <TextBox.Styles>
                                        <Style Selector="TextBox:pressed /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                        <Style Selector="TextBox:pointerover /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                    </TextBox.Styles>
                                </TextBox>
                            </StackPanel>
                            <StackPanel Grid.Column="4" DockPanel.Dock="Right">
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Repetition delay</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">ستُستخدم هذه القيمة لتعيين مؤقت بالدقائق، بحيث ينتظر النظام بين كل تكرار للعملية.

                                                    على سبيل المثال، إذا تم تعيينه على 30، فإن النظام سينتظر 30 دقيقة بعد التكرار الأول قبل بدء التكرار الثاني.</TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>
                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        Foreground="{StaticResource Secondary}"
                                        FontWeight="SemiLight"
                                        Text="wait b"/>
                                </StackPanel>
                                <TextBox
                                    Watermark="Ex : 30"
                                    Padding="5"
                                    FontFamily="{StaticResource Roboto}"
                                    HorizontalContentAlignment="Center"
                                    Text="{Binding ReportingSettingsValuesDisplay.RepetitionDelay,Mode=TwoWay}"
                                >
                                    <TextBox.Styles>
                                        <Style Selector="TextBox:pressed /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                        <Style Selector="TextBox:pointerover /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                    </TextBox.Styles>
                                </TextBox>
                            </StackPanel>
                          
                        </Grid>
                    </Border>
                    
                    <Border Margin="0,0,0,15"
                            CornerRadius="5"
                           >
                        <StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <PathIcon
                                    Margin="0,0,4,0"
                                    FontFamily="{StaticResource Roboto}"
                                    Width="14"
                                    FontWeight="Light"
                                    Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                    <ToolTip.Tip>
                                        <StackPanel>
                                            <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                       FontFamily="{StaticResource Roboto}" >Repetition delay</TextBlock>
                                            <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                       FontFamily="{StaticResource Roboto}">This setting determines how the system will handle proxies in the process(es). <LineBreak></LineBreak>

                                                <TextBlock FontWeight="Bold">Random</TextBlock>: The process will not use the proxy associated with the email account. Instead, it will randomly assign a proxy to the email account.<LineBreak></LineBreak>

                                                <TextBlock FontWeight="Bold">Fixed</TextBlock>: The system will assign a unique proxy for each email account</TextBlock>
                                        </StackPanel>
                                    </ToolTip.Tip>
                                </PathIcon>
                                <TextBlock
                                    FontFamily="{StaticResource Roboto}"
                                    FontSize="14"
                                    Foreground="{StaticResource Secondary}"
                                    FontWeight="SemiLight"
                                    Text="Proxy Sittings"/>
                            </StackPanel>
                            <Grid ColumnDefinitions="*,1,*"
                                  Background="white"
                            >
                                <ToggleButton Content="Fixed"
                                              Margin="2"
                                              Background="Transparent"
                                              HorizontalAlignment="Stretch"
                                              HorizontalContentAlignment="Center"
                                              IsChecked="{Binding IsFixed}"
                                              Classes="SegmentButton"
                                              Command="{Binding SelectProxySettingsCommand}"
                                              CommandParameter="Fixed">
                                    <ToggleButton.Styles>
                                        <Style Selector="ToggleButton">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource Primary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pointerover /template/ ContentPresenter">
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Secondary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                        <Style Selector="ToggleButton:checked /template/ ContentPresenter#PART_ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Primary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                    </ToggleButton.Styles>
                                </ToggleButton>

                                <Border Grid.Column="1" Width="1" Background="Gray" Margin="0,0,5,0" />

                                <ToggleButton Grid.Column="2" Content="Random"
                                              Margin="2"
                                              Background="Transparent"
                                              HorizontalContentAlignment="Center"
                                              HorizontalAlignment="Stretch"
                                              IsChecked="{Binding IsRandom}"
                                              Classes="SegmentButton"
                                              Command="{Binding SelectProxySettingsCommand}"
                                              CommandParameter="Random">
                                    <ToggleButton.Styles>
                                        <Style Selector="ToggleButton">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource Primary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pointerover /template/ ContentPresenter">
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Secondary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                        <Style Selector="ToggleButton:checked /template/ ContentPresenter#PART_ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Primary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                    </ToggleButton.Styles>
                                </ToggleButton>
                            </Grid>
                            <DockPanel  HorizontalAlignment="Stretch">
                                <Button HorizontalAlignment="Right" Content="reset" Cursor="Hand">
                                    <Button.Styles>
                                        <Style Selector="Button">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                        </Style>
                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                        </Style>
                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                        </Style>
                                    </Button.Styles>
                                </Button>
                            </DockPanel>
                        </StackPanel>
                       
                    </Border>
                        
                    
                    
                        <Border Background="White" Margin="0,0,0,5"
                                     CornerRadius="5"
                                     Padding="5"
                                     VerticalAlignment="Bottom">
                                 <StackPanel>
                                     <Button 
                                         Command="{Binding OpenPopupCommand}"
                                         HorizontalAlignment="Stretch"
                                         Cursor="Hand"
                                         Margin="0,0,0,2"
                                         Background="Transparent">
                                         <Grid ColumnDefinitions="20,*,*">
                                             <PathIcon Data="{StaticResource SelectIcon}" Foreground="{StaticResource Primary}" HorizontalAlignment="Left"/>
                                             <TextBlock Grid.Column="2" Text="Select Process(s)" HorizontalAlignment="Right"/>
                                         </Grid>
                                     </Button>
            
                                     <!-- WrapPanel for displaying icons -->
                                     <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                         <ItemsControl ItemsSource="{Binding ReportingselectedProcessesToIcon}">
                                             <ItemsControl.ItemsPanel>
                                                 <ItemsPanelTemplate>
                                                     <WrapPanel Orientation="Horizontal"/>
                                                 </ItemsPanelTemplate>
                                             </ItemsControl.ItemsPanel>
                                             <ItemsControl.ItemTemplate>
                                                 <DataTemplate>
                                                     <PathIcon Data="{Binding ., Converter={StaticResource IconNameToResourceConverter}}"
                                                               Width="16" Height="16" Foreground="{StaticResource Secondary}" Margin="4,0"/>
                                                 </DataTemplate>
                                             </ItemsControl.ItemTemplate>
                                         </ItemsControl>
                                     </WrapPanel>
                                 </StackPanel>
                             </Border>


                     </StackPanel>
                    <Border Grid.Row="1" Padding="5">
                        <Button Content="Start" Background="{StaticResource Primary}" Foreground="{StaticResource MainWhite}"
                                HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                Cursor="Hand" Command="{Binding ReadAllEmailsInboxMessagesCommand }">
                            
                        </Button>
                    </Border>
                </Grid>
               
                
                
                
            </Border>
               
        </Border>

        
        <!--Main Content-->
        <Border Grid.Column="0"
                Padding="3"
                Margin="7"
                CornerRadius="4"
                IsVisible="{Binding !IsLoading , Mode=TwoWay}"
               >
            <Grid ColumnDefinitions="5*,1,2*" 
                  RowDefinitions="40,*"
                  >
                <!--side progress area-->
                <Border  Grid.Row="0" Grid.Column="2"
                         Grid.RowSpan="2"
                        Margin="7,0,0,0"
                        >
                    <Grid RowDefinitions="170,*">
                         <Grid ColumnDefinitions="*,10,*,10,*">
                             <Border Background="#ffe9e1" CornerRadius="0,0,55,55"
                                     Padding="9">
                                 <Grid RowDefinitions="30,*">
                                     <TextBlock Text="Logical Processors" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"
                                                FontSize="11" HorizontalAlignment="Center"/>
                                     <TextBlock Grid.Row="1" Text="{Binding LogicalProcessorCountDisplay}" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"/>

                                 </Grid>

                             </Border>
                             <Border Grid.Column="2" Background="#eaefe8" CornerRadius="0,0,55,55"
                                     Padding="9">
                                 <Grid RowDefinitions="30,*">
                                     <TextBlock FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"
                                                FontSize="11" HorizontalAlignment="Center">
                                         <TextBlock Text="Recommended " /> <LineBreak /> <TextBlock Text="Batch Size" HorizontalAlignment="Center" />
                                     </TextBlock>
                                     <TextBlock Grid.Row="1" Text="{Binding RecommendedBatchSizeDisplay}" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"/>

                                 </Grid>

                             </Border>
                             <Border Grid.Column="4" Background="#f0d7ed" CornerRadius="0,0,55,55"
                                     Padding="9">
                                 <Grid RowDefinitions="30,*">
                                     <TextBlock FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"
                                                FontSize="11" HorizontalAlignment="Center">
                                         <TextBlock Text="Recommended " /> <LineBreak /> <TextBlock Text="maxDegreeOfParallelism" />
                                     </TextBlock>
                                     <TextBlock Grid.Row="1" Text="{Binding RecommendedMaxDegreeOfParallelismDisplay}" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"/>

                                 </Grid>

                             </Border>
                             
                        </Grid>
                        
                        <Border Grid.Row="1"
                                Margin="0,40,0,0"
                               Padding="10,0">
                            <Grid RowDefinitions="60,*">
                                <Border Background="White"
                                        Padding="10"
                                        Margin="0,0,0,10">
                                    <DockPanel >
                                        <TextBlock Text="Processes"
                                                   HorizontalAlignment="Center"
                                                   FontFamily="{StaticResource Roboto}"
                                                   FontWeight="Medium"
                                                   FontSize="20"></TextBlock>
                                    </DockPanel>
                                </Border>
                                <Border Grid.Row="1" Background="#F3F5F7"
                                        
                                >
                                    <DockPanel>
                                        <TabControl  Background="White" >
                                            
                                            <TabItem Header="Normal" FontSize="14" >
                                                <!-- Content for the 'All' section -->
                                                <taskCardDesign:NormalTasks />
                                            </TabItem>

                                          
                                            <TabItem Header="Campaign" FontSize="14" >
                                                <StackPanel >
                                                    <Grid IsVisible="{Binding IsRunning}">
                                                        <TextBlock  HorizontalAlignment="Left">
                                                            <TextBlock Text="{Binding Tour}"></TextBlock>
                                                            <TextBlock>/</TextBlock>
                                                            <TextBlock Text="{Binding ReportingSettingsValuesDisplay.Repetition}"></TextBlock>
                                                        </TextBlock>
                                                        <TextBlock Text="{Binding State}" HorizontalAlignment="Center"></TextBlock>
                                                        <TextBlock Foreground="Olive" FontFamily="{StaticResource Roboto}" FontWeight="Black" Text="{Binding TimeUntilNextRun, Converter={StaticResource TimeSpanToStringConverter}}" HorizontalAlignment="Right" />
                                                    </Grid>
                                                    
                                                    <taskCardDesign:CampaignTasks />
                                                </StackPanel>
                                               
                                            </TabItem>
                                        </TabControl>

                                    </DockPanel>
                                    
                                    
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
                <Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" Background="{StaticResource LightGrey}" />
                <!--Content-->
                <Border  Grid.RowSpan="2" Grid.Row="0" Grid.Column="0"
                       >
                    <Grid  
                        
                          ColumnDefinitions="*,10,Auto"
                          RowDefinitions="40,*">
                        <StackPanel Orientation="Horizontal" Spacing="2">
                            <Button Grid.Row="0" Grid.Column="0"
                                    Background="Transparent"
                                    CornerRadius="100"
                                    Click="ToggleSideMenu"
                                    BorderThickness="3"
                                    Cursor="Hand"
                                   
                                    >
                                <Button.Styles>
                                    <Style Selector="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Style>
                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                    <Style Selector="Button:selected /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                </Button.Styles>
                                <PathIcon  Data="{StaticResource GearIcon}" >
                                    <PathIcon.Styles>
                                        <Style Selector="PathIcon">
                                            <Setter Property="Foreground" Value="{StaticResource TentGrey}"/>
                                        </Style>
                                        <Style Selector="PathIcon:pointerover">
                                            <Setter Property="Foreground" Value="{StaticResource MainGreen}" />
                                        </Style>
                                    </PathIcon.Styles>
                                </PathIcon>
                            </Button>
                           <Button Grid.Row="0" Grid.Column="0"
                                    Background="Transparent"
                                    CornerRadius="100"
                                    Command="{Binding ReconnectToApiCommand}"
                                    BorderThickness="3"
                                    Cursor="Hand"
                                    
                                    >
                                <Button.Styles>
                                    <Style Selector="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Style>
                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                    <Style Selector="Button:selected /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                </Button.Styles>
                                <PathIcon  Data="{StaticResource SyncIcon}" >
                                    <PathIcon.Styles>
                                        <Style Selector="PathIcon">
                                            <Setter Property="Foreground" Value="{StaticResource TentGrey}"/>
                                        </Style>
                                        <Style Selector="PathIcon:pointerover">
                                            <Setter Property="Foreground" Value="{StaticResource MainAlert}" />
                                        </Style>
                                    </PathIcon.Styles>
                                </PathIcon>
                            </Button>
                        </StackPanel>
                       
                        <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Horizontal" >
                            <Border BorderThickness="1"
                                    BorderBrush="{StaticResource LightGrey}"
                                    CornerRadius="6"
                                    Height="">
                                <Button HorizontalAlignment="Right"
                                        Background="Transparent"
                                        Theme="{StaticResource CustomBtn}"
                                        Command="{Binding OpenFileUploadPopupCommand}">
                                    <DockPanel>
                                        <PathIcon Data="{StaticResource UploadIcon}"
                                                  Width="14"
                                                  Margin="0,0,12,0"
                                                  Foreground="{StaticResource MainAlert}"/>
                                        <TextBlock Text="upload"
                                                   FontFamily="{StaticResource Roboto}" 
                                                   Foreground="{StaticResource MainAlert}"/>
                                    </DockPanel>
                                </Button>
                            </Border>
                           
                            
                            <Border  Background="{StaticResource MainAlert}"
                                     Margin="20,0,7,0"
                                     Height="34"
                                     Width="34"
                                     CornerRadius="20">
                                <Button 
                                       
                                        Background="Transparent"
                                        x:Name="NotificationElement"
                                        Theme="{StaticResource CustomBtn}"
                                        Command="{Binding OpenNotificationopupCommand}">
                             
                                    <PathIcon Data="{StaticResource NotificationIcon}"
                                              Width="16"
                                           
                                              Foreground="{StaticResource LightGrey}"/>
                               
                                </Button> 
                            </Border>
                           
                        </StackPanel> 
                        <Grid RowDefinitions="*,*,3*"  Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3">
                            <Border  Padding="10">
                                <Grid ColumnDefinitions="*,20,*,20,*">
                                    
                                    <Border CornerRadius="20" Padding="15" Background="#ffe9e1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid ColumnDefinitions="*,*" >
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding TasksCount , Mode=TwoWay}" FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                                    <Border  VerticalAlignment="Center" Background="{StaticResource SecondaryGreen}" Padding="7" CornerRadius="12" Margin="9,0,0,0">
                                                        <TextBlock Text="{Binding RemainingOpenTasks}" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="White" FontWeight="Black"
                                                                   ></TextBlock>
                                                    </Border>
                                                </StackPanel>
                                                <TextBlock Text="ON GOING" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" >
                                                <Svg Path="/Assets/image/binary-coding.svg"
                                                     Width="100" 
                                                     Height="100" 
                                                     Stretch="Uniform" 
                                                     StretchDirection="Both"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    <Border Grid.Column="2" CornerRadius="20" Padding="15" Background="#f0d7ed" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid ColumnDefinitions="*,*" >
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="3" FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                                    <Border  VerticalAlignment="Center" Background="White" Padding="5" CornerRadius="12" Margin="9,0,0,0">
                                                        <TextBlock Text="27 min" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}" FontWeight="Black"
                                                        ></TextBlock>
                                                    </Border>
                                                </StackPanel>
                                                <TextBlock Text="PENDING" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" >
                                                <Svg Path="/Assets/image/deadline.svg"
                                                     Width="100" 
                                                     Height="100" 
                                                     Stretch="Uniform" 
                                                     StretchDirection="Both"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    <Border Grid.Column="4" CornerRadius="20" Padding="15" Background="#eaefe8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid ColumnDefinitions="*,*" >
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="4h 30min" FontSize="30" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                                </StackPanel>
                                                <TextBlock Text="Begin at" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" >
                                                <Svg Path="/Assets/image/clock.svg"
                                                     Width="100" 
                                                     Height="100" 
                                                     Stretch="Uniform" 
                                                     StretchDirection="Both"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    
                                </Grid>
                            </Border>
                           
                            <Border Grid.Row="1" Padding="100,0">
                                <StackPanel VerticalAlignment="Center"  HorizontalAlignment="Stretch" >
                                    <Border 
                                            BorderBrush="{StaticResource LightGrey}"
                                            CornerRadius="20"
                                            BorderThickness="1"
                                            Padding="4">
                                        <Grid ColumnDefinitions="Auto,*,Auto">
                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent" Command="{Binding OpenCampaignPopupCommand }">
                                                <StackPanel Orientation="Horizontal">
                                                    <PathIcon Width="13" Data="{StaticResource AddIcon}" Foreground="{StaticResource MainGreen}" Margin="0,0,10,0" />
                                                    <TextBlock Text="Add campain" Foreground="{StaticResource MainGreen}" FontFamily="{StaticResource Roboto}"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                        </Grid>
                                    </Border>
                                    <Border  Width="130"  Height="30" BorderBrush="{StaticResource LightGrey}"
                                             Background="{StaticResource MainAlert}"
                                            BorderThickness="1,0,1,1"
                                            CornerRadius="0,0,9,9"> 
                                        <Button Theme="{StaticResource CustomBtn}" Background="Transparent" VerticalAlignment="Top">
                                            <StackPanel Orientation="Horizontal">
                                                <PathIcon Width="11" Data="{StaticResource FlagIcon}" Foreground="{StaticResource LightGrey}" Margin="0,0,10,0" />
                                                <TextBlock Text="view full" Foreground="{StaticResource LightGrey}" FontSize="11" FontFamily="{StaticResource Roboto}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </Border>
                                </StackPanel>
                               
                            </Border>
                                <Border Grid.Row="2" Grid.Column="0"
                                        Background="White"
                                        Margin="10"
                                        BorderBrush="#B8B8B8"
                                        BorderThickness="0"
                                        CornerRadius="15"
                                        Padding="15">
                                    <Grid RowDefinitions="50,*">
                                        <Border>
                                            <Grid>
                                                <TextBlock
                                                    FontFamily="{StaticResource Roboto}"
                                                    FontSize="17"
                                                    FontWeight="ExtraBold"
                                                    Text="Email Data-Grid"
                                                    Foreground="{StaticResource TextMain}"
                                                    VerticalAlignment="Center"/>
                                                <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center"
                                                           Text="{Binding CountFilter}"
                                                           Foreground="{StaticResource TextMain}"
                                                           FontFamily="{StaticResource Roboto}"
                                                           FontWeight="Bold"
                                                           FontSize="24"></TextBlock>
                                                <Button x:Name="GridFilterButton" DockPanel.Dock="Right"
                                                        Background="{StaticResource MainAlert}"
                                                        Foreground="{StaticResource TentGrey}"
                                                        Width="100"
                                                        Padding="3"
                                                        BorderBrush="#F6F7EB"
                                                        BorderThickness="2"
                                                       VerticalAlignment="Center"
                                                        Command="{Binding ToggleGridFilterPopupCommand}" HorizontalAlignment="Right" >
                                                    <Button.Styles>
                                                        <Style Selector="Button">
                                                            <Setter Property="Background" Value="Transparent" />
                                                        </Style>
                                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                            <Setter Property="Background" Value="{StaticResource MainAlert}" />
                                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                           </Style>
                                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                                            <Setter Property="Background" Value="{StaticResource MainAlert}" />
                                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                        </Style>
                                                    </Button.Styles>
                                                    
                                                    <DockPanel >
                                                        
                                                        <TextBlock Text="Filter"
                                                                   Foreground="#F6F7EB"
                                                                   FontFamily="{StaticResource Roboto}"></TextBlock>
                                                        <PathIcon x:Name="FilterIcon" HorizontalAlignment="Right" Foreground="#F6F7EB" Data="{StaticResource GridPopupIconFilter}"></PathIcon>
                                                    </DockPanel>
                                                  
                                                </Button>

                                                <!-- Popup that shows when IsPopupOpen is true -->
                                                <Popup IsLightDismissEnabled="True" 
                                                       Width="350"
                                                       Height="550"
                                                       PlacementTarget="{Binding ElementName=GridFilterButton}" 
                                                       IsOpen="{Binding IsGridPopupOpen, Mode=TwoWay}">
                                                    <Border BorderBrush="#CFD2CD" BorderThickness="1" Background="{StaticResource LightGrey}"
                                                            CornerRadius="15"
                                                            Padding="15"
                                                            Width="350"
                                                            Height="550"
                                                          >
                                                        
                                                        <Grid RowDefinitions="30, 2,2*, 1,*, 1,*,1,*, 1,*, 1,40"
                                                            >
                                                            <TextBlock Text="Filter"
                                                                       FontFamily="{StaticResource Roboto}"
                                                                       Foreground="{StaticResource Primary}"
                                                                       FontWeight="Bold"
                                                                       HorizontalAlignment="Center"/>
                                                            <Border Grid.Row="1" Background="{StaticResource Primary}" />
                                                            <Border Grid.Row="2"
                                                                    Padding="7,10">
                                                                <Grid RowDefinitions="30,*">
                                                                
                                                                    <TextBlock FontFamily="{StaticResource Roboto}"
                                                                               Foreground="{StaticResource Primary}"
                                                                               Text="by Group"/>
                                                                     
                                                                
                                                                    <Border Grid.Row="1" >
                                                                        <ComboBox   HorizontalAlignment="Stretch"
                                                                                   VerticalAlignment="Center" 
                                                                                   PlaceholderText="Group"
                                                                                   Background="{StaticResource MainWhite}"
                                                                                   Foreground="{StaticResource Primary}"
                                                                                   ItemsSource="{Binding Groups}"
                                                                                   SelectedItem="{Binding SelectedEmailGroupFilter}">
                                                                                    
                                                                        </ComboBox>
                                                                    </Border>
                                                                  
                                                                </Grid>
                                                            </Border> 
                                                            <Border Grid.Row="3" Background="{StaticResource Primary}" />
                                                            <Border Grid.Row="5" Background="{StaticResource Primary}" />
                                                            <Border Grid.Row="4"
                                                                    Padding="7,10">
                                                                <Grid RowDefinitions="*">
                                                                
                                                                    
                                                                
                                                                    <Border  Background="{StaticResource MainWhite}">
                                                                        <StackPanel  Orientation="Horizontal" HorizontalAlignment="Center"
                                                                            >
                                                                           
                                                                            <CheckBox   HorizontalAlignment="Stretch"
                                                                                VerticalAlignment="Center" 
                                                                            IsChecked="{Binding IsGetContainSpam}">
                                                                                    
                                                                            </CheckBox>
                                                                            <TextBlock Text="Contain spam" VerticalAlignment="Center" ></TextBlock>
                                                                        </StackPanel>
                                                                        
                                                                    </Border>
                                                                  
                                                                </Grid>
                                                            </Border>
                                                            <Border Grid.Row="6"
                                                                    Padding="7,10">
                                                                <Grid ColumnDefinitions="*,*" RowDefinitions="30,*">
                                                                    <TextBlock Text="Spam Count Range"
                                                                               FontFamily="{StaticResource Roboto}"
                                                                               Foreground="{StaticResource Primary}" 
                                                                               Grid.ColumnSpan="2"/>
                                                                    <StackPanel Orientation="Horizontal" Grid.Row="1">
                                                                        <TextBlock Text="Min:"
                                                                            VerticalAlignment="Center"
                                                                            Margin="0,0,5,0"/>
                                                                        <TextBox Width="50"
                                                                            Text="{Binding SpamCountMin, Mode=TwoWay}"
                                                                            HorizontalAlignment="Left"
                                                                            VerticalAlignment="Center"/>
                                                                        <TextBlock Text="Max:"
                                                                            VerticalAlignment="Center"
                                                                            Margin="10,0,5,0"/>
                                                                        <TextBox Width="50"
                                                                            Text="{Binding SpamCountMax, Mode=TwoWay}"
                                                                            HorizontalAlignment="Left"
                                                                            VerticalAlignment="Center"/>
                                                                    </StackPanel>
                                                                </Grid>
                                                            </Border>
                                                            <Border Grid.Row="12"
                                                                   >
                                                              
                                                                    <DockPanel>
                                                                        <Button Cursor="Hand" HorizontalAlignment="Left" Content="Apply" Command="{Binding FilterTableCommand}">
                                                                            <Button.Styles>
                                                                                <Style Selector="Button">
                                                                                    <Setter Property="Background" Value="{StaticResource Primary}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                                                                </Style>
                                                                            </Button.Styles>

                                                                        </Button>
                                                                        <Button HorizontalAlignment="Right" Content="reset" Command="{Binding ResetFilterTableCommand}" >
                                                                            <Button.Styles>
                                                                                <Style Selector="Button">
                                                                                    <Setter Property="Background" Value="{StaticResource MainRed}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                                                                </Style>
                                                                            </Button.Styles>
                                                                        </Button>
                                                                    </DockPanel>
                                                            </Border>
                                                        </Grid>
                                                    </Border>
                                                </Popup>
                                            </Grid>
                                        </Border>
                                        <DataGrid
                                            Grid.Row="1" ItemsSource="{Binding EmailDiaplysTable ,Mode=TwoWay}" 
                                            AutoGenerateColumns="False"
                                            GridLinesVisibility="All"
                                            BorderThickness="1" BorderBrush="{StaticResource Primary}"
                                            IsReadOnly="True"
                                            CanUserReorderColumns="True"
                                           >
                                            <DataGrid.Styles>
                                                <Style Selector="DataGridColumnHeader">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Background" Value="White" />
                                                    <Setter Property="FontFamily" Value="{StaticResource Roboto}"></Setter>
                                                </Style>
                                            </DataGrid.Styles>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn  Header="Id" Foreground="Black" Binding="{Binding Id}" Width="Auto"/>
                                                <DataGridTextColumn  Header="EmailAddress" Foreground="Black" Binding="{Binding EmailAddress}" Width="Auto"/>
                                                <DataGridTextColumn Header="Group" Foreground="Black" Binding="{Binding Group.GroupName}" Width="Auto"/>
                                                <DataGridTextColumn Header="Inbox count" Foreground="Black" Binding="{Binding Stats.InboxCount}" Width="*"/>
                                                <DataGridTextColumn Header="Spam count" Foreground="Black" Binding="{Binding Stats.SpamCount}" Width="*"/>
                                                <DataGridTextColumn Header="last archive" Foreground="Black" Binding="{Binding Stats.LastArchivedCount}" Width="*"/>
                                                <DataGridTextColumn Header="last read" Foreground="Black" Binding="{Binding Stats.LastReadCount}" Width="*"/>
                                                <DataGridTextColumn Header="last reported count" Foreground="Black" Binding="{Binding Stats.LastNotSpamCount}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </Grid>
                    
                         </Border>
                           
                        </Grid>
                        <!--<StackPanel Grid.Row="3" Grid.Column="2">
                            <TextBlock Text="Task Messages:" FontWeight="Bold"/>
                            <ListBox ItemsSource="{Binding TaskMessages,Mode=TwoWay}" />

                            <TextBlock Text="Error Messages:" FontWeight="Bold" Margin="0,10,0,0"/>
                            <ListBox ItemsSource="{Binding ErrorMessages}" />
    
                            <Button Content="Start Tasks" Command="{Binding StartTasksCommand}" />
                        </StackPanel>-->
                       
                    </Grid>
                   
            </Border>
                
            
            </Grid>
        </Border>
        
        <!--upload popup-->
        <Border IsVisible="{Binding IsUploadPopupOpen}" 
                Background="LightGray" 
                HorizontalAlignment="Center" 
                BorderThickness="1"
                BorderBrush="{StaticResource LightGrey}"
                VerticalAlignment="Top"
                Margin="0,20,0,0"
                IsEnabled="{Binding IsEnabled , Mode=TwoWay}">
            
            <StackPanel Orientation="Horizontal">
             
                <Border Background="White"  Padding="10"
                        Width="600"
                        Height="500">
                    <Grid RowDefinitions="40,*,40"
                         >
                        <Border>
                            <DockPanel>
                                <TextBlock Text="Upload File" FontFamily="{StaticResource Roboto}"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource TextMain}"
                                           HorizontalAlignment="Center" Margin="0,0,0,20" />
                                
                                <Button Theme="{StaticResource CustomBtn}" HorizontalAlignment="Right"
                                        Command="{Binding CloseFileUploadPopupCommand}"
                                        Width="24"
                                        VerticalAlignment="Top"
                                        Background="Transparent">
                                    
                                    <PathIcon Data="{StaticResource CloseAppIcon}"></PathIcon>
                                </Button>
                            </DockPanel>
                        </Border>
                        <Grid  Grid.Row="1"
                               RowDefinitions="3*,*">
                            
                            <StackPanel>
                                <Grid Margin="20"
                                      DragDrop.AllowDrop="True"
                                      DragDrop.Drop="Border_OnDrop">
                                    <Rectangle StrokeDashArray="4, 2" Stroke="{StaticResource Secondary}" StrokeThickness="2" RadiusX="3" RadiusY="3"  Fill="White"></Rectangle>
                                    <Border BorderBrush="{StaticResource Secondary}"  BorderThickness="0" CornerRadius="5" Padding="20" HorizontalAlignment="Center" VerticalAlignment="Center"
                                            Background="Transparent"
                                           >
                                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <PathIcon Data="{StaticResource FileUploadIcon}" Foreground="{StaticResource MainAlert}" Width="50" Height="50"
                                                      Margin="0,0,0,50"/>
                                            <DockPanel>
                                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{StaticResource TextMain}"
                                                           FontFamily="{StaticResource Roboto}">
                                                    Drag and Drop file here or  
                                                </TextBlock>
                                                <Button Content="Choose file"
                                                        FontFamily="{StaticResource Roboto}"   
                                                        HorizontalContentAlignment="Center"
                                                        Click="ChooseFileButton_Click"
                                                        Foreground="{StaticResource Secondary}" HorizontalAlignment="Center"
                                                        Background="Transparent" BorderBrush="Transparent"
                                                        Cursor="Hand"
                                                        FontWeight="SemiBold"/>
                                            </DockPanel>
                                          
                                          
                                           
                                            
                                        </StackPanel>
                                    </Border>
                                </Grid>
                                
                                <Border></Border>
                                <TextBlock Text="Supported formats: XLS, XLSX , TXT" HorizontalAlignment="Center" FontSize="10"
                                           Foreground="{StaticResource TextMain}"/>
                                
                                <Border Background="{StaticResource LightGrey}"
                                        Margin="0,20,0,0"
                                        CornerRadius="7"
                                        Padding="10"
                                        Height="90">
                                    <StackPanel>
                                        <DockPanel Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="{Binding FileName}"></TextBlock>
                                                <TextBlock >
                                                    <TextBlock Text="{Binding FileSize}"></TextBlock>
                                                    <TextBlock Text=" mb"></TextBlock>
                                                </TextBlock>
                                            </StackPanel>
                                            <Button 
                                                    Theme="{StaticResource CustomBtn}"
                                                    Command="{Binding CancelTaskCommand}"
                                                    CommandParameter="{Binding CancelUploadToken}"
                                                    IsEnabled="{Binding IsUploading}" 
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Top"
                                                    Background="Transparent"
                                                  
                                                >
                                            <PathIcon Data="{StaticResource CloseAppIcon}"
                                                      ></PathIcon>
                                                </Button>
                                        </DockPanel>
                                        <Grid ColumnDefinitions="*,40">
                                            <ProgressBar Minimum="0" 
                                                         Maximum="100" 
                                                         Value="{Binding UploadProgress}" 
                                                         Height="10"
                                                         Background="{StaticResource MainWhite}"
                                                         Foreground="{StaticResource MainGreen}"
                                                         Margin="0,10,0,0"/>
                                            <TextBlock Grid.Column="1" HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"> <TextBlock Text="{Binding UploadProgress}"></TextBlock>%</TextBlock>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                
                              
            
                                <!-- Cancel Upload Button -->
                            
                            </StackPanel>
                          
                        </Grid>
                      

                        <Border Grid.Row="2">
                            <Button Content="Done" HorizontalAlignment="Center" Background="{StaticResource Primary}"  Command="{Binding CloseFileUploadPopupCommand}"  Foreground="{StaticResource MainWhite}"
                                    Width="120" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                    Cursor="Hand">
                                    
                            </Button>
                        </Border>
                    </Grid>
                
                </Border>
                    <Border Background="White" 
                            Margin="1,0,0,0"
                            Width="350"
                            Height="500"
                            >
                        <Grid >
                            <Border Grid.RowSpan="5"   IsVisible="{Binding !IsEnabled , Mode=TwoWay}">
                                <li:LoadingIndicator VerticalAlignment="Center" HorizontalAlignment="Center" Width="50" Height="50" IsActive="{Binding !IsEnabled , Mode=TwoWay}"  Mode="Arcs" SpeedRatio="1.2"/>
                            </Border>
                            <Border Padding="12,12,12,0">
                                <Grid RowDefinitions="40,Auto,Auto,Auto,60,Auto,*"  >
                                    <Border>
                                        <TextBlock Text="group selection"
                                                   FontFamily="{StaticResource Roboto}"
                                                   Foreground="{StaticResource TextMain}"
                                                   FontWeight="Medium"
                                                   HorizontalAlignment="Center"
                                                   FontStyle="Oblique"/>
                                    </Border>
                                    <RadioButton  Grid.Row="1" Content="this will provide you with a form to create new group and assign it to the uploaded list of emails"
                                                  Tag="Create a new group"
                                                  GroupName="VisitOption"
                                                  Height="100"
                                                  Command="{Binding SelectNewGroupCommand}"
                                                  IsChecked="{Binding IsNewGroupSelected, Mode=TwoWay}"
                                                  Theme="{StaticResource CustomRadioButtonTheme}" 
                                                  Margin="0,0,0,10">
                                    </RadioButton>
                                     <RadioButton  Grid.Row="2" Content="this will provide you with a list that contain already pre created groups to choose from"
                                                   Tag="select existing"
                                                   GroupName="VisitOption"
                                                   Command="{Binding SelectExistingGroupCommand}"
                                                   IsChecked="{Binding IsExistingGroupSelected, Mode=TwoWay}"
                                                   Theme="{StaticResource CustomRadioButtonTheme}" />  
                                     <RadioButton  Grid.Row="3" Content="selecting this option will provide you with a group drop down to delete a group"
                                                   Tag="select to delete"
                                                   GroupName="VisitOption"
                                                   Command="{Binding SelectDeleteGroupCommand}"
                                                   IsChecked="{Binding IsDeleteGroupSelected, Mode=TwoWay}"
                                                   Theme="{StaticResource CustomRadioButtonTheme}" />
                            
                                    <StackPanel Grid.Row="4" IsVisible="{Binding IsNewGroupSelected}" Orientation="Vertical" Spacing="5">
                                        <TextBox 
                                                 Padding="9"
                                                 BorderBrush="{StaticResource LightGrey}"
                                                 CornerRadius="9"
                                                 UseFloatingWatermark="False"
                                            
                                                 Watermark="Enter new group name"
                                                 FontFamily="{StaticResource Roboto}"
                                                 
                                                 Text="{Binding NewGroupName, Mode=TwoWay}" />  
                                        <TextBox 
                                                 Padding="9"
                                                 BorderBrush="{StaticResource LightGrey}"
                                                 CornerRadius="9"
                                                 UseFloatingWatermark="False"
                                            
                                                 Watermark="Enter RDP IP"
                                                 FontFamily="{StaticResource Roboto}"
                                                 
                                                 Text="{Binding RdpIp, Mode=TwoWay}" />
                                        <Border   Width="140"
                                                  BorderBrush="{StaticResource LightGrey}"
                                                  BorderThickness="0"
                                                  CornerRadius="9"
                                                  Background="{StaticResource MainAlert}">
                                            <Button Content="Create Group"
                                                  
                                                    Background="Transparent"
                                                   Foreground="{StaticResource MainWhite}"
                                                    Theme="{StaticResource CustomBtn}"
                                                    Command="{Binding CreateNewGroupCommand}" />
                                        </Border>
                                      
                                    </StackPanel>
                                
                                    <ComboBox Grid.Row="5" ItemsSource="{Binding Groups,Mode=TwoWay}"
                                              SelectedItem="{Binding SelectedEmailGroup, Mode=TwoWay}"
                                              IsEnabled="{Binding IsExistingGroupSelected}"
                                              IsVisible="{Binding IsExistingGroupSelected}"
                                              PlaceholderText="Select a group">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding GroupName}" />
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                     <StackPanel Grid.Row="5" Orientation="Vertical" HorizontalAlignment="Center"
                                                 IsEnabled="{Binding IsDeleteGroupSelected}"
                                                 IsVisible="{Binding IsDeleteGroupSelected}">
                                         <ComboBox  ItemsSource="{Binding Groups,Mode=TwoWay}"
                                                    SelectedItem="{Binding SelectedEmailGroup, Mode=TwoWay}"
                                                    PlaceholderText="Select a group to delete"
                                                    Padding="3"
                                                    FontFamily="{StaticResource Roboto}">
                                             <ComboBox.ItemTemplate>
                                                 <DataTemplate>
                                                     <TextBlock Text="{Binding GroupName}" />
                                                 </DataTemplate>
                                             </ComboBox.ItemTemplate>
                                         </ComboBox>
                                         
                                         <Button Command="{Binding DeleteGroupCommand}"
                                                 Foreground="White"
                                             HorizontalAlignment="Center" Theme="{StaticResource CustomBtn}" Content="Delete" Background="{StaticResource MainRed}" >
                                             
                                         </Button>
                                     </StackPanel>
                                    

                            <!-- Display selected group details, for demonstration purposes -->
                                     <Border  Grid.Row="6" >
                                         <Border Width="220"
                                                 Height="30"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Bottom"
                                                 Background="{StaticResource Primary}"
                                                 Padding="4"
                                                 CornerRadius="9,9,0,0">
                                             <TextBlock 
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Bottom"
                                                 FontFamily="{StaticResource Roboto}"
                                                 Foreground="{StaticResource MainWhite}"
                                                       >
                                                 <TextBlock Text="Selected Group: "/><TextBlock  Foreground="{Binding SelectedEmailGroup.GroupName, Converter={StaticResource GroupNameToColorConverter}}"  Text="{Binding SelectedEmailGroup.GroupName}"/>
                                             </TextBlock>
                                         </Border>
                                       
                                     </Border>
                          
                        
                                </Grid>
                            </Border>
                           
                        </Grid>
                        
                    </Border>
            </StackPanel>
           
            </Border>
        
            <Border Background="Transparent" Width="1480" Height="900"  IsVisible="{Binding IsPopupOpen}"
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center" 
                    ZIndex="100"
                    Margin="100,0,0,0">
                <Border Background="White" BoxShadow="0 0 12 5 #60847577"   Width="1420" Height="800">
                    
                    <Grid ColumnDefinitions="*,2,400">
                     
                        <!-- Content on the left -->
                            <Grid RowDefinitions="50,2,*,50,12" Background="White">
                                <Border Background="White" >
                                    <TextBlock Text="Processes Panel"
                                               FontFamily="{StaticResource Roboto}"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Foreground="{StaticResource Primary}"
                                               FontWeight="Bold"></TextBlock>
                                </Border>
                                <Border Grid.Row="1" Background="{StaticResource SLightGrey}"></Border>
                                <Border Grid.Row="2"  Padding="10" >
                                    <StackPanel  Spacing="20">
                                        <!--Title-->
                                        <Border>
                                            <StackPanel>
                                                <TextBlock Text="Select Process(s)"
                                                           Foreground="{StaticResource Primary}"
                                                           HorizontalAlignment="Center"
                                                           FontWeight="Bold"
                                                           FontSize="20"
                                                           FontFamily="{StaticResource Roboto}"/>
                                                <TextBlock HorizontalAlignment="Center" >
                                                
                                                    <TextBlock  >
                                                        <TextBlock Text="You not sure how it works ? download guide"
                                                                   FontWeight="Medium"
                                                                   FontSize="12"
                                                                   Foreground="{StaticResource Secondary}"
                                                                   FontFamily="{StaticResource Roboto}"/>
                                                        <Button Background="Transparent">
                                                            <TextBlock Text="here"
                                                                       TextDecorations="underline"
                                                                       FontWeight="Bold"
                                                                       FontSize="14"
                                                                       Foreground="{StaticResource Primary}"
                                                                       FontFamily="{StaticResource Roboto}"/>
                                                        </Button>
                                                    </TextBlock>
                                                </TextBlock>
                                            </StackPanel>
                                          
                                        </Border>
                                        <!--content-->
                                        
                                        <Grid RowDefinitions="*,10">
                                           <Grid RowDefinitions="50,*">
                                            
                                               
                                               
                                               <Grid Grid.Row="1"
                                                     ColumnDefinitions="*,Auto,*"
                                                     RowDefinitions="*,20,*">
                                                   
                                                   <StackPanel Orientation="Horizontal" Spacing="20" Grid.Column="1">
                                                       <CheckBox Grid.Column="0" Content="Reporting" 
                                                                 Command="{Binding ProcessesCheckedManagerCommand}" 
                                                                 CommandParameter="IsReportingSelected"
                                                                 IsChecked="{Binding SelectedProcessesUi.IsReportingSelected, Mode=TwoWay}"
                                                                 Width="200"
                                                                 Height="120">
                                                                <CheckBox.Template>
                                                                    <ControlTemplate>
                                                                        <Border Background="White"
                                                                                CornerRadius="2"
                                                                                Padding="10"
                                                                                 BorderBrush="{Binding IsReportingChoiceSelected, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                                BorderThickness="1"
                                                                                >
                                                                            <StackPanel VerticalAlignment="Center">
                                                                                <PathIcon Foreground="#8093F1" Data="{StaticResource ReportingIcon}" Width="30" Height="30" HorizontalAlignment="Center"/>
                                                                                <TextBlock Text="Reporting" HorizontalAlignment="Center" Foreground="{Binding IsReportingChoiceSelected, Converter={StaticResource SelectedForgroundConverter}}" FontFamily="{StaticResource Roboto}" FontWeight="SemiBold" Margin="0,8,0,4"/>
                                                                            </StackPanel>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </CheckBox.Template>
                                                            </CheckBox>
                                                       <CheckBox  Cursor="Hand"  Content="Disappearing" Command="{Binding ProcessesCheckedManagerCommand}" IsChecked="{Binding SelectedProcessesUi.IsMMRI}"
                                                                  Width="200"
                                                                  Height="120">
                                                                <CheckBox.Template>
                                                                    <ControlTemplate>
                                                                        <Border Background="White"
                                                                                CornerRadius="2"
                                                                                Padding="10"
                                                                                BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                                BorderThickness="1">
                                                                            <StackPanel VerticalAlignment="Center">
                                                                                <PathIcon   Foreground="#EE2F69" Data="{StaticResource DeleteSpamIcon}" Width="30" Height="30" HorizontalAlignment="Center"/>
                                                                               
                                                                                <TextBlock Text="Delete Spam" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}" FontWeight="Bold" Margin="0,8,0,4"
                                                                                    Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                                <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                            </StackPanel>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </CheckBox.Template>
                                                            </CheckBox>
                                                       <CheckBox Cursor="Hand"  Content="Disappearing" 
                                                                 Command="{Binding ProcessesCheckedManagerCommand}" 
                                                                 CommandParameter="MarkMessagesAsReadFromInbox"
                                                                 IsChecked="{Binding  SelectedProcessesUi.IsMMRI}"
                                                                 Width="200"
                                                                 Height="120">
                                                                <CheckBox.Template>
                                                                    <ControlTemplate>
                                                                        <Border Background="White"
                                                                                CornerRadius="2"
                                                                                Padding="10"
                                                                                BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                                BorderThickness="1">
                                                                            <StackPanel VerticalAlignment="Center">
                                                                                <PathIcon   Foreground="{StaticResource Read}" Data="{StaticResource MarkReadIcon}" Width="30" Height="30"  HorizontalAlignment="Center"/>
                                                                               
                                                                                <TextBlock Text="Read messages" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}" FontWeight="Bold" Margin="0,8,0,4"
                                                                                    Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                                <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                            </StackPanel>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </CheckBox.Template>
                                                            </CheckBox>
                                                       <CheckBox Cursor="Hand" Content="Disappearing" 
                                                                              Command="{Binding ProcessesCheckedManagerCommand}" 
                                                                              CommandParameter="ArchiveMessages"
                                                                              IsChecked="{Binding  SelectedProcessesUi.IsArchiveSelected}"
                                                                              Width="200"
                                                                              Height="120">
                                                                <CheckBox.Template>
                                                                    <ControlTemplate>
                                                                        <Border Background="White"
                                                                                CornerRadius="2"
                                                                                Padding="10"
                                                                                BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                                BorderThickness="1">
                                                                            <StackPanel VerticalAlignment="Center">
                                                                                <PathIcon   Foreground="#78CEBD" Data="{StaticResource ArchiveIcon}" Width="30" Height="30"  HorizontalAlignment="Center"/>
                                                                               
                                                                                <TextBlock Text="Archive messages" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}" FontWeight="Bold" Margin="0,8,0,4"
                                                                                    Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                                <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                            </StackPanel>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </CheckBox.Template>
                                                            </CheckBox>
                                                   </StackPanel>
                                                   <StackPanel Orientation="Horizontal" Spacing="20" Grid.Row="2"
                                                               Grid.Column="1">
                                                           <CheckBox Cursor="Hand"   Content="Reporting" Command="{Binding ProcessesCheckedManagerCommand}" IsChecked="{Binding SelectedProcessesUi.IsGetSpamNumbersSelected}"
                                                                          CommandParameter="CollectMessagesCount"
                                                                          Width="200"
                                                                          Height="120">
                                                                    <CheckBox.Template>
                                                                        <ControlTemplate>
                                                                            <Border Background="White"
                                                                                    CornerRadius="2"
                                                                                    Padding="10"
                                                                                    BorderBrush="{Binding IsCollectDataSelected, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                                    BorderThickness="1">
                                                                                <StackPanel VerticalAlignment="Center">
                                                                                    <PathIcon Foreground="#C695EF" Data="{StaticResource CollectSpamNumberIcon}" Width="30" Height="30" HorizontalAlignment="Center"/>
                                                                                    <TextBlock Text="Collect Data" FontFamily="{StaticResource Roboto}" HorizontalAlignment="Center" FontWeight="Bold" Margin="0,8,0,4"
                                                                                        Foreground="{Binding IsCollectDataSelected, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                                    <!--<TextBlock Text="Alert is sent as soon as person appears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                                </StackPanel>
                                                                            </Border>
                                                                        </ControlTemplate>
                                                                    </CheckBox.Template>
                                                                </CheckBox>
                                                        <CheckBox  Cursor="Hand"  Content="Disappearing" Command="{Binding ProcessesCheckedManagerCommand}" IsChecked="{Binding SelectedProcessesUi.IsFixAfterFinish}"
                                                                   Width="420"
                                                                   Height="120">
                                                                    <CheckBox.Template>
                                                                        <ControlTemplate>
                                                                            <Border Background="White"
                                                                                    CornerRadius="2"
                                                                                    Padding="10"
                                                                                    BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                                    BorderThickness="1">
                                                                                <StackPanel VerticalAlignment="Center">
                                                                                    <PathIcon  Foreground="#D39CB6" Data="{StaticResource FixIcon}" Width="30" Height="30" HorizontalAlignment="Center"/>
                                                                                    
                                                                                    <TextBlock Text="Fix Errors" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}"  FontWeight="Bold" Margin="0,8,0,4"
                                                                                        Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                                    <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                                </StackPanel>
                                                                            </Border>
                                                                        </ControlTemplate>
                                                                    </CheckBox.Template>
                                                                </CheckBox>
                                                     
                                                   </StackPanel>
                                                   
                                                </Grid>  
                                            
                                           </Grid>
                                            
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                <StackPanel IsVisible="{Binding IsCampaignSelected}" Grid.Row="3" Spacing="10" Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button  Content="Add campaign" HorizontalAlignment="Center" Background="{StaticResource MainAlert}"  Command="{Binding AddSingleCampaignTaskCommand}"  Foreground="{StaticResource MainWhite}"
                                             Width="120" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                             Cursor="Hand">
                                                                        
                                    </Button>
                                    <Button  Grid.Row="3" Content="Close" HorizontalAlignment="Center" Background="#42494C"  Command="{Binding ClosePopupCommand}"  Foreground="{StaticResource MainWhite}"
                                             Width="120" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                             Cursor="Hand">
                                                                        
                                    </Button>
                                </StackPanel>
                                <Button Grid.Row="3" IsVisible="{Binding !IsCampaignSelected}"  Content="Done" HorizontalAlignment="Center" Background="#1570ef"  Command="{Binding ClosePopupCommand}"  Foreground="{StaticResource MainWhite}"
                                        Width="120" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                        Cursor="Hand">
                                                                        
                                </Button>
                            </Grid>
                            <Border Grid.Column="1" Background="{StaticResource SLightGrey}"></Border>
                        <!-- Pane on the right -->
                        <Border Grid.Column="2" Padding="10">
                            <ScrollViewer>
                                      <StackPanel Spacing="30">
                                <TextBlock Text="settings"
                                           FontFamily="{StaticResource Roboto}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="{StaticResource TextMain}"
                                           FontWeight="Bold"></TextBlock>
                                
                             <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Interval</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">سيتم استخدام هذا المربع لتحديد المجموعات التي ستعمل في هذه المهمة.
                                                    يمكنك الضغط على CTRL + للاختيار المتعدد، وإذا لم يتم تحديد أي مجموعة، فسيتم اعتبار جميع المجموعات محددة.
                                                    </TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>
                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        Foreground="{StaticResource Secondary}"
                                        FontWeight="SemiLight"
                                        Text="Group Selection"/>
                                </StackPanel>
                                <Border  Margin="1" BorderBrush="{StaticResource LightGrey}" BorderThickness="1" >
                                      <Grid       ColumnDefinitions="*"
                                            Background="white">
                                          <StackPanel>
                                              <Button Name="DropdownButton1"
                                                      HorizontalAlignment="Stretch"
                                                      Theme="{StaticResource CustomBtn}"
                                                      Background="{StaticResource Primary}"
                                                      Content="Select Groups"
                                                      Foreground="{StaticResource LightGrey}"
                                                      Command="{Binding ToggleGroupSelctionMenuOneCommand }"/>

                                              <Popup Name="DropdownPopup1"
                                                     PlacementTarget="{Binding ElementName=DropdownButton1}"
                                                     PlacementMode="Bottom"
                                                     IsOpen="{Binding IsGroupSettingsDropdownOpen1, Mode=TwoWay}">

                                                  <Border BorderBrush="{StaticResource Primary}"
                                                          BorderThickness="1"
                                                          Background="White" >
                                                      <ListBox HorizontalAlignment="Stretch"
                                                          VerticalAlignment="Top"
                                                          Padding="2"
                                                          Background="White"
                                                          Foreground="{StaticResource Primary}"
                                                          ItemsSource="{Binding Groups}"
                                                          SelectionMode="Multiple"
                                                          SelectedItems="{Binding SelectedEmailGroupForTask}"
                                                          />
                                                  </Border>
                                              </Popup>
                                          </StackPanel>
                                </Grid>
                                </Border>
                            </StackPanel>
                                <!--collect data-->
                                <Border Background="#35C695EF" Padding="7"
                                        IsVisible="{ Binding IsCollectDataSelected}">
                                    <Grid RowDefinitions="30,Auto">
                                        <DockPanel>
                                            <PathIcon Width="15" Height="15"    Foreground="{StaticResource CollectData}" Data="{StaticResource CollectSpamNumberIcon}" HorizontalAlignment="Left"></PathIcon>
                                            <TextBlock Text="collect Data"
                                                       FontFamily="{StaticResource Roboto}"
                                                       HorizontalAlignment="Right"
                                                       Foreground="{StaticResource CollectData}"
                                                       FontWeight="Bold"></TextBlock>
                                        </DockPanel>
                                     
                                        <StackPanel Grid.Row="1" Spacing="10">
                                            <ListBox Grid.Row="1"
                                                     ItemsSource="{Binding Folders}"
                                                     Cursor="Hand"
                                                     FontFamily="{StaticResource Roboto}"
                                                     SelectionMode="Multiple"
                                                     BorderBrush="{StaticResource CollectData}"
                                                     BorderThickness="1"
                                                     SelectionChanged="OnSelectionChanged"/>
                                            <StackPanel Spacing="4">
                                                <CheckBox Content="Generate Subject Collector"    FontFamily="{StaticResource Roboto}" IsChecked="{Binding IsGenerateCsvSubjectTableRequested}" />
                                                <StackPanel Spacing="3" IsVisible="{Binding IsGenerateCsvSubjectTableRequested}">
                                                    <Border Background="White">
                                                        <Grid ColumnDefinitions="*,30">
                                                            <TextBox BorderThickness="0" VerticalAlignment="Center" Background="Transparent" Text="{Binding PathToSaveSubjectFile}"></TextBox>

                                                            <Button Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Left" Width="30" Height="30" 
                                                                    Background="Transparent"
                                                                    Cursor="Hand"
                                                                    Click="SelectPathForSubjectFile">
                                                                <PathIcon Data="{StaticResource FolderIcon}" Width="20"
                                                                          
                                                                          Height="20"
                                                                          Foreground="{StaticResource MainAlert}"></PathIcon>
                                                            </Button>
                                                        </Grid>
                                                    </Border>
                                                  
                                                    
                                                    <TextBox Text="{Binding SubjectFileName}"
                                                             Watermark="file name"
                                                             BorderThickness="0" VerticalAlignment="Center" Background="White"
                                                             
                                                    ></TextBox>
                                                </StackPanel>
                                              
                                            </StackPanel>    
                                            <StackPanel Spacing="4">
                                                <CheckBox Content="Create Count File"    FontFamily="{StaticResource Roboto}"  IsChecked="{Binding IsGenerateNumberCollectionRequested}"/>
                                                <StackPanel Spacing="3" IsVisible="{Binding IsGenerateNumberCollectionRequested}">
                                                    <Border Background="White">
                                                        <Grid ColumnDefinitions="*,30">
                                                            <TextBox BorderThickness="0" VerticalAlignment="Center" Background="Transparent" Text="{Binding PathToSaveCountFile}"></TextBox>

                                                            <Button Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Left" Width="30" Height="30" 
                                                                    Background="Transparent"
                                                                    Cursor="Hand"
                                                                    Click="SelectPathForCountFile">
                                                                <PathIcon Data="{StaticResource FolderIcon}" Width="20"
                                                                          
                                                                          Height="20"
                                                                          Foreground="{StaticResource MainAlert}"></PathIcon>
                                                            </Button>
                                                        </Grid>
                                                    </Border>
                                                  
                                                    
                                                    <TextBox Text="{Binding CountFileName}"
                                                             Watermark="file name"
                                                             BorderThickness="0" VerticalAlignment="Center" Background="White"
                                                             
                                                    ></TextBox>
                                                </StackPanel>
                                                
                                            </StackPanel>
                                           
                                           
                                        </StackPanel>
                                       
                                    </Grid>
                                    
                                </Border>
                                <!--mark as read -->
                                <Border Background="#3542494C" Padding="7"
                                        IsVisible="{ Binding IsMMRIChoiceSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource Read}" Data="{StaticResource MarkReadIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <TextBlock Text="Mark as read"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource Read}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <ComboBox Grid.Row="1" ItemsSource="{Binding Folders}"
                                                              Cursor="Hand"
                                                              FontFamily="{StaticResource Roboto}"
                                                              HorizontalAlignment="Stretch"
                                                              HorizontalContentAlignment="Center"
                                                              BorderBrush="{StaticResource Read}"
                                                              BorderThickness="1"
                                                              SelectedItem="{Binding SelectedFolders, Mode=TwoWay}"
                                                              PlaceholderText="Select Folder"/>
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:MMRIThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>  
                                <!--Archive messages-->
                                <Border Background="#3578CEBD" Padding="7"
                                        IsVisible="{ Binding IsArchiveChoiceSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource SecondaryGreen}" Data="{StaticResource ArchiveIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <TextBlock Text="archive messages"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource SecondaryGreen}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:ArchiveThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>
                                <!--mark as not spam-->
                                <Border Background="#358093F1" Padding="7"
                                        IsVisible="{ Binding IsReportingChoiceSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource Spam}" Data="{StaticResource ReportingIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <CheckBox Margin="9,0,0,0" Width="20" Height="20"
                                                              Cursor="Hand"
                                                              IsChecked="{Binding MarkMessagesAsNotSpamConfig.PreReportingSettings.IsPreReporting}">
                                                        
                                                    </CheckBox>
                                                    <TextBlock Text="Mark as spam"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource Spam}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:MNSThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>
                            </StackPanel>
                            </ScrollViewer>
                          
                        </Border>
                           
                      
                    </Grid>
                  
            </Border>
        </Border>
            <Popup IsLightDismissEnabled="True" 
                   Width="600"
                   Height="550"
                   
                   PlacementTarget="{Binding ElementName=NotificationElement}" 
                   IsOpen="{Binding IsNotificationOpen, Mode=TwoWay}">
                        <Border BorderBrush="#CFD2CD" BorderThickness="1"  Background="White"
                            CornerRadius="15"
                            Padding="15"
                            Width="550"
                            Height="550"
                        >
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Border BorderBrush="LightGray" BorderThickness="1" Cursor="Hand" Margin="0,0,0,10" >
                                    <Button Theme="{StaticResource CustomBtn}"
                                            Command="{Binding ClearAllNotificationsCommand}"
                                            Background="White">
                                        <TextBlock Text="Clear All" ></TextBlock>
                                    </Button>
                                </Border>
                                <ScrollViewer Grid.Row="1" >
                                     <ListBox ItemsSource="{Binding NotificationTasks}" Background="White">
                                                <ListBox.Styles>
                                                    <!-- Style for ListBoxItem -->
                                                    <Style Selector="ListBoxItem">
                                                        <Setter Property="Background" Value="Transparent"/>
                                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                                    </Style>
                                                    <!-- Hover effect -->
                                                    <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="Transparent" />
                                                      
                                                    </Style>
                                                    <!-- Selected effect -->
                                                    <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="Transparent" />
                                                    </Style>
                                                </ListBox.Styles>

                                                <ListBox.ItemTemplate>
                                                   <DataTemplate>
                                                       <Border>
                                                           <StackPanel>
                                                               <Border Cursor="Hand" HorizontalAlignment="Center" CornerRadius="5,5,0,0" Background="{StaticResource LightGrey}"  Padding="1"  BoxShadow="0 0 0.5 1 LightGray"
                                                                       PointerPressed="OnTaskIdBorderPointerPressed">
                                                                   <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="{Binding AssignedEmails[0].Group.GroupName}" Margin="5" FontSize="12" FontFamily="{StaticResource Roboto}" FontWeight="SemiLight" Foreground="{StaticResource Primary}" />
                                                               </Border>
                                                               <Border CornerRadius="5"
                                                               BorderThickness="1"
                                                               Padding="0"
                                                               BorderBrush="DarkGray"
                                                               Background="White"
                                                       >
                                                            <Grid RowDefinitions="*,4">
                                                                <Border Padding="6,6,6,6">
                                                                    <Grid RowDefinitions="*,25,*">
                                                                         <Grid ColumnDefinitions="*,Auto,*" RowDefinitions="35" Margin="0,0,0,4">
                                                                            <StackPanel Orientation="Horizontal">
                                                                                <Ellipse  VerticalAlignment="Center" Width="10" Height="10" Fill="#027BCE" Margin="0,0,5,0"/>
                                                                                <TextBlock VerticalAlignment="Center" Text="{Binding StartTime}"  FontFamily="{StaticResource Roboto}"  ></TextBlock>
                                                                            </StackPanel>
                                                                             
                                                                             <StackPanel Grid.Column="1"
                                                                                 HorizontalAlignment="Center" Orientation="Horizontal">
                                                                        
                                                                      
                                                                        
                                                                                <!-- Conditionally visible TextBlock for Success Messages -->
                                                                                <Border Margin="0,0,6,0" Width="50" Height="50" Padding="2" BorderBrush="{StaticResource SecondaryGreen}" CornerRadius="3" BorderThickness="0"  IsVisible="{Binding TakInfoType, Converter={StaticResource TaskInfoTypeToVisibilityConverter}}">
                                                                                    <TextBlock VerticalAlignment="Center" Text="{Binding ItemSuccesMessasges.Count}"
                                                                                        Margin="5" FontSize="12" FontFamily="{StaticResource Roboto}" 
                                                                                        FontWeight="SemiBold" Foreground="{StaticResource MainGreen}"
                                                                                        HorizontalAlignment="Center"
                                                                                       />
                                                                                </Border>    
                                                                                <Border Padding="2" Width="50" Height="50" BorderBrush="{StaticResource SecondaryAlert}" CornerRadius="3" BorderThickness="0"  IsVisible="{Binding TakInfoType, Converter={StaticResource TaskInfoTypeToVisibilityConverter}}">
                                                                                    <!-- Conditionally visible TextBlock for Failed Messages -->
                                                                                    <TextBlock Text="{Binding ItemFailedMessasges.Count}"
                                                                                        Margin="5" FontSize="12" FontFamily="{StaticResource Roboto}" 
                                                                                        FontWeight="SemiBold" Foreground="{StaticResource MainAlert}"
                                                                                        HorizontalAlignment="Center"
                                                                                        VerticalAlignment="Center"
                                                                                       />
                                                                                </Border>
                                                                           
                
                                                                          
                                                                            </StackPanel>
                                                                            <Border Grid.Column="2"
                                                                                BorderBrush="{Binding Color}"
                                                                                    BorderThickness="1"
                                                                                    Background="{Binding SoftColor}"
                                                                                    Padding="7"
                                                                                    CornerRadius="15"
                                                                                    HorizontalAlignment="Right">
                                                                                <TextBlock Text="{Binding Name}"  FontSize="13" FontFamily="{StaticResource Roboto}" FontWeight="Medium" Foreground="{Binding Color}"/>
                                                                            </Border>
                                                                        </Grid>
                                                                                    <!--detail button-->
                                                                                    <Grid Grid.Row="2" ColumnDefinitions="*,*,*">
                                                                                        <Border  Width="80"  Height="30" BorderBrush="{StaticResource LightGrey}"
                                                                                            Background="{StaticResource MainAlert}"
                                                                                            
                                                                                            BorderThickness="1,0,1,1"
                                                                                            CornerRadius="0,0,9,9"> 
                                                                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent" VerticalAlignment="Top"
                                                                                                Command="{Binding ToggleViewMoreDetailsCommand}">
                                                                                                <StackPanel Orientation="Horizontal">
                                                                                                    <PathIcon Width="11" Data="{StaticResource FlagIcon}" Foreground="{StaticResource LightGrey}" Margin="0,0,10,0" />
                                                                                                    <TextBlock Text="Details" Foreground="{StaticResource LightGrey}" FontSize="11" FontFamily="{StaticResource Roboto}"></TextBlock>
                                                                                                </StackPanel>
                                                                                            </Button>
                                                                                        </Border>
                                                                                        <Popup IsLightDismissEnabled="True" 
                                                                                            Width="1620"
                                                                                            Height="900"
                                                                                            Placement="Center"
                                                                                            VerticalAlignment="Top"
                                                                                            HorizontalAlignment="Center"
                                                                                            PlacementTarget="{Binding ElementName=MainGrid}" 
                                                                                            IsOpen="{Binding IsMoreDetailNeeded, Mode=TwoWay}">
                                                                                            <components1:TaskDetailPopup />
                                                                                        </Popup> 
                                                                                        
                                                                                                <!--error type-->
                                                                                        <Border Grid.Column="1" Width="80" Height="30" BorderBrush="{StaticResource LightGrey}"
                                                                                                Background="{StaticResource SLightGrey}"

                                                                                                BorderThickness="1,0,1,1"
                                                                                                CornerRadius="0,0,9,9">
                                                                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent"
                                                                                                    VerticalAlignment="Top"
                                                                                                    Command="{Binding ToggleErrorTypeCommand}">
                                                                                                <StackPanel Orientation="Horizontal">
                                                                                                    <PathIcon Width="11" Data="{StaticResource FlagIcon}"
                                                                                                              Foreground="{StaticResource LightGrey}"
                                                                                                              Margin="0,0,10,0" />
                                                                                                    <TextBlock Text="Error"
                                                                                                               Foreground="{StaticResource TextMain}"
                                                                                                               FontSize="11" FontFamily="{StaticResource Roboto}">
                                                                                                    </TextBlock>
                                                                                                </StackPanel>
                                                                                            </Button>
                                                                                        </Border>
                                                                                        <Popup IsLightDismissEnabled="True"
                                                                                               Width="1000"
                                                                                               Height="900"
                                                                                               Placement="Center"
                                                                                               VerticalAlignment="Top"
                                                                                               HorizontalAlignment="Center"
                                                                                               PlacementTarget="{Binding ElementName=MainGrid}"
                                                                                               IsOpen="{Binding IsErrorTypeNeeded, Mode=TwoWay}">
                                                                                            <components1:ErrorTypePopup />
                                                                                        </Popup>
                                                                                        <Border Grid.Column="2" Width="80"  Height="30" BorderBrush="{StaticResource LightGrey}"
                                                                                            Background="{StaticResource MainRed}"
                                                                                            
                                                                                            BorderThickness="1,0,1,1"
                                                                                            CornerRadius="0,0,9,9"> 
                                                                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent" VerticalAlignment="Top"
                                                                                                Command="{Binding ToggleViewConsoleDetailsCommand}">
                                                                                                <StackPanel Orientation="Horizontal">
                                                                                                    <PathIcon Width="11" Data="{StaticResource FlagIcon}" Foreground="{StaticResource LightGrey}" Margin="0,0,10,0" />
                                                                                                    <TextBlock Text="console" Foreground="{StaticResource LightGrey}" FontSize="11" FontFamily="{StaticResource Roboto}"></TextBlock>
                                                                                                </StackPanel>
                                                                                            </Button>
                                                                                        </Border>
                                                                                        <Popup IsLightDismissEnabled="True" 
                                                                                            Width="1620"
                                                                                            Height="900"
                                                                                            Placement="Center"
                                                                                            VerticalAlignment="Top"
                                                                                            HorizontalAlignment="Center"
                                                                                            PlacementTarget="{Binding ElementName=MainGrid}" 
                                                                                            IsOpen="{Binding IsConsoleNeeded, Mode=TwoWay}">
                                                                                            <components1:ConsoleLog />
                                                                                        </Popup>
                                                                                    </Grid>
                                                                    </Grid>
                                                                </Border>
                                                               
                                                                <Border Grid.Row="1" CornerRadius="0,0,5,5" Background="{Binding Color}"></Border>
                                                            </Grid>
                                                        </Border>
                                                           </StackPanel>
                                                       </Border>
                                                       
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                </ScrollViewer>
                               
                            </Grid>
                            
                           
                             
                        </Border>
            </Popup>
    </Grid>
</UserControl>

