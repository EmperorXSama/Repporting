<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:RepportingApp.ViewModels"
             xmlns:local="clr-namespace:Reporting.lib.enums;assembly=Reporting.lib"
             xmlns:li="using:LoadingIndicators.Avalonia"
             xmlns:components1="clr-namespace:RepportingApp.Views.Components"
             xmlns:taskCardDesign="clr-namespace:RepportingApp.Views.Components.TaskCardDesign"
             mc:Ignorable="d"   d:DesignWidth="1620" d:DesignHeight="900"
             x:Class="RepportingApp.Views.ReportingPageView"
             x:DataType="viewModels:ReportingPageViewModel">
    <Grid x:Name="MainGrid" Background="White" >
        <Border ZIndex="10000">
            <components1:ErrorIndicatorView DataContext="{Binding ErrorIndicator}" />
        </Border>
        <Border  ZIndex="10000"   IsVisible="{Binding IsLoading , Mode=TwoWay}">
            <li:LoadingIndicator VerticalAlignment="Center" HorizontalAlignment="Center" Width="50" Height="50" IsActive="{Binding IsLoading , Mode=TwoWay}"  Mode="Arcs" SpeedRatio="1.2"/>
        </Border>
        <Grid.ColumnDefinitions>
            <!-- Main content column -->
            <ColumnDefinition Width="*" /> 
            <!-- Side menu column, this will be adjusted dynamically in the code-behind -->
            <ColumnDefinition Width="0" /> <!-- Default width for menu column is 0 (collapsed) -->
        </Grid.ColumnDefinitions>
        
        <!-- Side Menu -->
        <Border Grid.Column="1"
                Background="White"
                IsVisible="{Binding IsMenuOpen}"
                Padding="10">
       
            <Border Padding="10"  Background="#eeeeee">
                <Grid>
                    <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto">
                <Grid RowDefinitions="*,Auto">
                     <StackPanel >
                        <DockPanel>
                            <TextBlock Text="Sittings" FontWeight="SemiBold" Foreground="#847577" FontSize="16" Margin="10" FontFamily="{StaticResource Roboto}"/>
                            <Button Content="save" HorizontalAlignment="Right" Background="#077187"  Command="{Binding SaveSettingsCommand}"  Foreground="{StaticResource MainWhite}"
                                    Width="100" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                    Cursor="Hand" />
                        </DockPanel>
                        <Border BorderBrush="#847577" BorderThickness="1" Margin="0,0,0,15"></Border>
                        
                    <Border Background="White"
                            Padding="9"
                            Margin="0,0,0,15">
                        <Grid ColumnDefinitions="*,10,*,10,*" >
                            <StackPanel DockPanel.Dock="Left">
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Thread</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">سيتم استخدام القيمة لتحديد عدد حسابات البريد الإلكتروني التي سيتم معالجتها في كل مرة.
                                                    مثال: إذا كان لديك 500 حساب بريد إلكتروني وقمت بتحديد 50، فإن النظام سيقسم 500/50 وسيعالج كل مرة مجموعة من 50 حسابًا.</TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>
                                        
                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        FontWeight="Light"
                                        Text="Thread"
                                        Foreground="{StaticResource Secondary}"/>
                                </StackPanel>
                               <TextBox
                                   Watermark="Ex : 5"
                                   Padding="5"
                                   FontFamily="{StaticResource Roboto}"
                                   HorizontalContentAlignment="Center"
                                   Text="{Binding ReportingSettingsValuesDisplay.Thread,Mode=TwoWay}"
                               >
                                   <TextBox.Styles>
                                       <Style Selector="TextBox:pressed /template/ Border">
                                           <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                       </Style>
                                       <Style Selector="TextBox:pointerover /template/ Border">
                                           <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                       </Style>
                                   </TextBox.Styles>
                               </TextBox>
                            </StackPanel>
                            
                            <StackPanel  Grid.Column="2" DockPanel.Dock="Left">
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                      
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Repetition</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">سيتم استخدام هذه القيمة لتحديد عدد المرات التي سيعيد فيها النظام تنفيذ العملية.

                                                    على سبيل المثال، إذا قمت بتعيينها على 2، فعند انتهاء العملية ستبدأ من جديد (سيتم التعامل مع حسابات البريد الإلكتروني التي فشلت خلال التشغيل الأول بطريقة مختلفة).</TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>

                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        Foreground="{StaticResource Secondary}"
                                        FontWeight="SemiLight"
                                        Text="Repeat"/>
                                </StackPanel>
                                <TextBox 
                                    Watermark="Ex : 2"
                                    Padding="5"
                                    FontFamily="{StaticResource Roboto}"
                                    HorizontalContentAlignment="Center"
                                    BorderThickness="1"
                                    BorderBrush="{StaticResource Primary}"
                                    Text="{Binding ReportingSettingsValuesDisplay.Repetition,Mode=TwoWay}"
                                >
                                    <TextBox.Styles>
                                        <Style Selector="TextBox:pressed /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                        <Style Selector="TextBox:pointerover /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                    </TextBox.Styles>
                                </TextBox>
                            </StackPanel>
                            <StackPanel Grid.Column="4" DockPanel.Dock="Right">
                                <StackPanel Orientation="Horizontal">
                                    <PathIcon
                                        Margin="0,0,4,0"
                                        FontFamily="{StaticResource Roboto}"
                                        Width="14"
                                        FontWeight="Light"
                                        Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                        <ToolTip.Tip>
                                            <StackPanel>
                                                <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}" >Repetition delay</TextBlock>
                                                <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                           FontFamily="{StaticResource Roboto}">ستُستخدم هذه القيمة لتعيين مؤقت بالدقائق، بحيث ينتظر النظام بين كل تكرار للعملية.

                                                    على سبيل المثال، إذا تم تعيينه على 30، فإن النظام سينتظر 30 دقيقة بعد التكرار الأول قبل بدء التكرار الثاني.</TextBlock>
                                            </StackPanel>
                                        </ToolTip.Tip>
                                    </PathIcon>
                                    <TextBlock
                                        FontFamily="{StaticResource Roboto}"
                                        FontSize="14"
                                        Foreground="{StaticResource Secondary}"
                                        FontWeight="SemiLight"
                                        Text="wait b"/>
                                </StackPanel>
                                <TextBox
                                    Watermark="Ex : 30"
                                    Padding="5"
                                    FontFamily="{StaticResource Roboto}"
                                    HorizontalContentAlignment="Center"
                                    Text="{Binding ReportingSettingsValuesDisplay.RepetitionDelay,Mode=TwoWay}"
                                >
                                    <TextBox.Styles>
                                        <Style Selector="TextBox:pressed /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                        <Style Selector="TextBox:pointerover /template/ Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource Secondary}"/>
                                        </Style>
                                    </TextBox.Styles>
                                </TextBox>
                            </StackPanel>
                          
                        </Grid>
                    </Border>
                    
                    <Border Margin="0,0,0,15"
                            CornerRadius="5"
                           >
                        <StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <PathIcon
                                    Margin="0,0,4,0"
                                    FontFamily="{StaticResource Roboto}"
                                    Width="14"
                                    FontWeight="Light"
                                    Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
                                    <ToolTip.Tip>
                                        <StackPanel>
                                            <TextBlock FontSize="16" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                       FontFamily="{StaticResource Roboto}" >Repetition delay</TextBlock>
                                            <TextBlock FontSize="14" FontWeight="Light" HorizontalAlignment="Center" Foreground="{StaticResource Secondary}"
                                                       FontFamily="{StaticResource Roboto}">This setting determines how the system will handle proxies in the process(es). <LineBreak></LineBreak>

                                                <TextBlock FontWeight="Bold">Random</TextBlock>: The process will not use the proxy associated with the email account. Instead, it will randomly assign a proxy to the email account.<LineBreak></LineBreak>

                                                <TextBlock FontWeight="Bold">Fixed</TextBlock>: The system will assign a unique proxy for each email account</TextBlock>
                                        </StackPanel>
                                    </ToolTip.Tip>
                                </PathIcon>
                                <TextBlock
                                    FontFamily="{StaticResource Roboto}"
                                    FontSize="14"
                                    Foreground="{StaticResource Secondary}"
                                    FontWeight="SemiLight"
                                    Text="Proxy Sittings"/>
                            </StackPanel>
                            <Grid ColumnDefinitions="*,1,*"
                                  Background="white"
                            >
                                <ToggleButton Content="Fixed"
                                              Margin="2"
                                              Background="Transparent"
                                              HorizontalAlignment="Stretch"
                                              HorizontalContentAlignment="Center"
                                              IsChecked="{Binding IsFixed}"
                                              Classes="SegmentButton"
                                              Command="{Binding SelectProxySettingsCommand}"
                                              CommandParameter="Fixed">
                                    <ToggleButton.Styles>
                                        <Style Selector="ToggleButton">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource Primary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pointerover /template/ ContentPresenter">
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Secondary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                        <Style Selector="ToggleButton:checked /template/ ContentPresenter#PART_ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Primary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                    </ToggleButton.Styles>
                                </ToggleButton>

                                <Border Grid.Column="1" Width="1" Background="Gray" Margin="0,0,5,0" />

                                <ToggleButton Grid.Column="2" Content="Random"
                                              Margin="2"
                                              Background="Transparent"
                                              HorizontalContentAlignment="Center"
                                              HorizontalAlignment="Stretch"
                                              IsChecked="{Binding IsRandom}"
                                              Classes="SegmentButton"
                                              Command="{Binding SelectProxySettingsCommand}"
                                              CommandParameter="Random">
                                    <ToggleButton.Styles>
                                        <Style Selector="ToggleButton">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource Primary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pointerover /template/ ContentPresenter">
                                            <Setter Property="FontWeight" Value="SemiBold" />
                                            <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                        </Style>
                                        <Style Selector="ToggleButton:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Secondary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                        <Style Selector="ToggleButton:checked /template/ ContentPresenter#PART_ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource Primary}" />
                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                            <Setter Property="FontWeight" Value="Bold" />
                                        </Style>
                                    </ToggleButton.Styles>
                                </ToggleButton>
                            </Grid>
                            <DockPanel  HorizontalAlignment="Stretch">
                                <Button HorizontalAlignment="Right" Content="reset" Cursor="Hand">
                                    <Button.Styles>
                                        <Style Selector="Button">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                        </Style>
                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                        </Style>
                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                        </Style>
                                    </Button.Styles>
                                </Button>
                            </DockPanel>
                        </StackPanel>
                       
                    </Border>
                         

                    <Border Grid.Row="1" Padding="10">
                            <ScrollViewer>
                                      <StackPanel Spacing="30">
                                <TextBlock Text="settings"
                                           FontFamily="{StaticResource Roboto}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="{StaticResource TextMain}"
                                           FontWeight="Bold"></TextBlock>
                          <!-- Super Compact Inline Version -->
<Border Margin="15" 
        Padding="16" 
        Background="White"
        BorderBrush="#E5E7EB" 
        BorderThickness="1"
        CornerRadius="6">

    <StackPanel Spacing="12">
        
        <!-- Header with inline info -->
        <Grid ColumnDefinitions="Auto,*,Auto">
            <TextBlock Text="Move Emails" 
                       FontSize="14" 
                       FontWeight="Medium" 
                       VerticalAlignment="Center"/>
            
            <!-- Inline Info -->
            <TextBlock Grid.Column="1" 
                       FontSize="11" 
                       Foreground="#6B7280"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       IsVisible="{Binding ShowMoveInfo}">
                <Run Text="{Binding TotalEmailsToMove}"/>
                <Run Text="emails •"/>
                <Run Text="{Binding SelectedSourceGroupsCount}"/>
                <Run Text="groups"/>
            </TextBlock>
            
            <!-- Action Buttons -->
            <StackPanel Grid.Column="2" 
                        Orientation="Horizontal" 
                        Spacing="6">
                <Button Content="Move"
                        Padding="12,4"
                        FontSize="12"
                        Background="#2563EB"
                        Foreground="White"
                        CornerRadius="4"
                        Command="{Binding MoveEmailsBetweenGroupsCommand}"
                        IsEnabled="{Binding CanMoveEmails}"/>
                
                <Button Content="Clear"
                        Padding="12,4"
                        FontSize="12"
                        Background="Transparent"
                        Foreground="#6B7280"
                        BorderBrush="#D1D5DB"
                        BorderThickness="1"
                        CornerRadius="4"
                        Command="{Binding ClearMoveSelectionCommand}"/>
            </StackPanel>
        </Grid>

        <!-- Horizontal Layout for dropdowns -->
        <Grid ColumnDefinitions="*,Auto,*">
            
            <!-- From Multi-Select -->
            <Grid Grid.Column="0">
                <Button Background="#F9FAFB"
                        BorderBrush="#D1D5DB"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="10,6"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch"
                        Command="{Binding ToggleSourceDropdownCommand}">
                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <TextBlock Grid.Column="0" 
                                   Text="From: " 
                                   FontSize="11" 
                                   Foreground="#6B7280"
                                   VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" 
                                   VerticalAlignment="Center" 
                                   FontSize="12"
                                   FontWeight="Medium">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0} selected">
                                    <Binding Path="SelectedSourceGroupsCount"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                        <PathIcon Grid.Column="2" 
                                  Data="M19 9l-7 7-7-7" 
                                  Width="10" 
                                  Height="10"
                                  Foreground="#6B7280"
                                  Margin="4,0,0,0"/>
                    </Grid>
                </Button>
                
                <!-- Multi-Select Popup -->
                <Popup IsOpen="{Binding IsSourceDropdownOpen}"
                       PlacementMode="Bottom"
                       PlacementTarget="{Binding $parent[Button]}">
                    <Border Background="White"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1"
                            CornerRadius="4"
                            BoxShadow="0 2 4 0 #0000001A"
                            MaxHeight="150">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding SelectableGroups}"
                                          Margin="2">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected}"
                                                  Margin="4,2"
                                                  FontSize="11">
                                            <StackPanel Orientation="Horizontal" Spacing="4">
                                                <TextBlock Text="{Binding GroupName}"/>
                                                <TextBlock Text="{Binding EmailCount, StringFormat='({0})'}" 
                                                           Foreground="#2563EB" 
                                                           FontWeight="SemiBold"/>
                                            </StackPanel>
                                        </CheckBox>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Border>
                </Popup>
            </Grid>

            <!-- Arrow -->
            <TextBlock Grid.Column="1" 
                       Text="→" 
                       FontSize="16" 
                       Foreground="#2563EB"
                       VerticalAlignment="Center"/>

            <!-- To Single-Select -->
            <ComboBox Grid.Column="2"
                      ItemsSource="{Binding Groups}"
                      SelectedItem="{Binding SelectedDestinationGroup}"
                      PlaceholderText="To: Select destination..."
                      FontSize="12"
                      Padding="10,6"
                      Background="#F9FAFB"
                      BorderBrush="#D1D5DB"
                      CornerRadius="4">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Spacing="4">
                            <TextBlock Text="{Binding GroupName}" FontSize="11"/>
                            <TextBlock Text="{Binding EmailCount, StringFormat='({0})'}" 
                                       Foreground="#2563EB" 
                                       FontWeight="SemiBold"
                                       FontSize="11"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </Grid>

    </StackPanel>

</Border>
                             <StackPanel>
                               <!-- Simpler Compact Group Selection -->
<StackPanel Spacing="6">
    <StackPanel Orientation="Horizontal" Spacing="4">
        <PathIcon Width="14" FontWeight="Light" Data="{StaticResource HelpIcon}" Foreground="{StaticResource Secondary}">
            <ToolTip.Tip>
                <TextBlock FontSize="14" FontWeight="Light" Foreground="{StaticResource Secondary}"
                           FontFamily="{StaticResource Roboto}">Select groups for this task</TextBlock>
            </ToolTip.Tip>
        </PathIcon>
        
        <TextBlock FontFamily="{StaticResource Roboto}"
                   FontSize="14"
                   Foreground="{StaticResource Secondary}"
                   FontWeight="SemiLight"
                   Text="Group Selection"/>
    </StackPanel>
    
    <!-- Compact Dropdown -->
 <Border Width="350">
    <Grid>
        <Button Background="#F9FAFB"
                BorderBrush="#D1D5DB"
                BorderThickness="1"
                CornerRadius="6"
                Padding="12,8"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Stretch"
                Command="{Binding ToggleGroupSelectionDropdownCommand}">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Grid.Column="0" VerticalAlignment="Center" FontSize="13">
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}{0} groups selected">
                            <Binding Path="SelectedEmailGroupForTask.Count"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
                <PathIcon Grid.Column="1" 
                          Data="M19 9l-7 7-7-7" 
                          Width="10" 
                          Height="10"
                          Foreground="#6B7280"/>
            </Grid>
        </Button>
        
        <!-- Popup with fixes -->
        <Popup IsOpen="{Binding IsGroupSelectionDropdownOpen}"
               PlacementMode="Bottom"
               PlacementTarget="{Binding $parent[Button]}"
               IsLightDismissEnabled="True"
               IsHitTestVisible="True">
            <Border Background="White"
                    BorderBrush="#D1D5DB"
                    BorderThickness="1"
                    CornerRadius="6"
                    BoxShadow="0 4 6 -1 #0000001A"
                    MaxHeight="250"
                    Width="350">
                <Grid RowDefinitions="Auto,*">
                    <!-- Select All -->
                    <Border Grid.Row="0" 
                            Background="#F9FAFB"
                            BorderBrush="#E5E7EB"
                            BorderThickness="0,0,0,1"
                            Padding="12,8">
                        <CheckBox IsChecked="{Binding IsAllGroupsSelected}"
                                  Command="{Binding ToggleSelectAllGroupsCommand}"
                                  FontWeight="SemiBold"
                                  FontSize="13">
                            <TextBlock>
                                Select All
                                <Run Text="{Binding Groups.Count, StringFormat='({0})'}" 
                                     FontWeight="Normal"
                                     Foreground="#6B7280"/>
                            </TextBlock>
                        </CheckBox>
                    </Border>
                    
                    <!-- Groups with fixed scrolling -->
                    <ScrollViewer Grid.Row="1" 
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding SelectableTaskGroups}"
                                      Margin="4">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Vertical"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="8,4"
                                            Background="Transparent"
                                            PointerEntered="OnGroupItemPointerEntered"
                                            PointerExited="OnGroupItemPointerExited">
                                        <CheckBox IsChecked="{Binding IsSelected}"
                                                  HorizontalAlignment="Stretch">
                                            <Grid ColumnDefinitions="*,Auto,Auto" 
                                                  Width="290"
                                                  Margin="0,0,0,2">
                                                <TextBlock Grid.Column="0" 
                                                           FontSize="12"
                                                           TextTrimming="CharacterEllipsis">
                                                    <Run Text="{Binding GroupName}" FontWeight="Bold"/>
                                                    <Run Text="•" Foreground="#D1D5DB"/>
                                                    <Run Text="{Binding Group.RdpIp}" Foreground="#6B7280"/>
                                                </TextBlock>
                                                <TextBlock Grid.Column="1" 
                                                           Text="{Binding EmailCount}" 
                                                           Foreground="#2563EB" 
                                                           FontWeight="Bold"
                                                           FontSize="12"
                                                           Margin="8,0"/>
                                                <TextBlock Grid.Column="2" 
                                                           Text="{Binding Group.CreatedDate, StringFormat='{}{0:MM/dd}'}" 
                                                           FontSize="11"
                                                           Foreground="#9CA3AF"/>
                                            </Grid>
                                        </CheckBox>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Popup>
    </Grid>
</Border>
</StackPanel>
                            </StackPanel>
                                <!--collect data-->
                                <Border Background="#35C695EF" Padding="7"
                                        IsVisible="{ Binding IsCollectDataSelected}">
                                    <Grid RowDefinitions="30,Auto">
                                        <DockPanel>
                                            <PathIcon Width="15" Height="15"    Foreground="{StaticResource CollectData}" Data="{StaticResource CollectSpamNumberIcon}" HorizontalAlignment="Left"></PathIcon>
                                            <TextBlock Text="collect Data"
                                                       FontFamily="{StaticResource Roboto}"
                                                       HorizontalAlignment="Right"
                                                       Foreground="{StaticResource CollectData}"
                                                       FontWeight="Bold"></TextBlock>
                                        </DockPanel>
                                     
                                        <StackPanel Grid.Row="1" Spacing="10">
                                            <ListBox Grid.Row="1"
                                                     ItemsSource="{Binding Folders}"
                                                     Cursor="Hand"
                                                     FontFamily="{StaticResource Roboto}"
                                                     SelectionMode="Multiple"
                                                     BorderBrush="{StaticResource CollectData}"
                                                     BorderThickness="1"
                                                     SelectionChanged="OnSelectionChanged"/>
                                            <StackPanel Spacing="4">
                                                <CheckBox Content="Generate Subject Collector"    FontFamily="{StaticResource Roboto}" IsChecked="{Binding IsGenerateCsvSubjectTableRequested}" />
                                                <StackPanel Spacing="3" IsVisible="{Binding IsGenerateCsvSubjectTableRequested}">
                                                    <Border Background="White">
                                                        <Grid ColumnDefinitions="*,30">
                                                            <TextBox BorderThickness="0" VerticalAlignment="Center" Background="Transparent" Text="{Binding PathToSaveSubjectFile}"></TextBox>

                                                            <Button Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Left" Width="30" Height="30" 
                                                                    Background="Transparent"
                                                                    Cursor="Hand"
                                                                    Click="SelectPathForSubjectFile">
                                                                <PathIcon Data="{StaticResource FolderIcon}" Width="20"
                                                                          
                                                                          Height="20"
                                                                          Foreground="{StaticResource MainAlert}"></PathIcon>
                                                            </Button>
                                                        </Grid>
                                                    </Border>
                                                  
                                                    
                                                    <TextBox Text="{Binding SubjectFileName}"
                                                             Watermark="file name"
                                                             BorderThickness="0" VerticalAlignment="Center" Background="White"
                                                             
                                                    ></TextBox>
                                                </StackPanel>
                                              
                                            </StackPanel>    
                                            <StackPanel Spacing="4">
                                                <CheckBox Content="Create Count File"    FontFamily="{StaticResource Roboto}"  IsChecked="{Binding IsGenerateNumberCollectionRequested}"/>
                                                <StackPanel Spacing="3" IsVisible="{Binding IsGenerateNumberCollectionRequested}">
                                                    <Border Background="White">
                                                        <Grid ColumnDefinitions="*,30">
                                                            <TextBox BorderThickness="0" VerticalAlignment="Center" Background="Transparent" Text="{Binding PathToSaveCountFile}"></TextBox>

                                                            <Button Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Left" Width="30" Height="30" 
                                                                    Background="Transparent"
                                                                    Cursor="Hand"
                                                                    Click="SelectPathForCountFile">
                                                                <PathIcon Data="{StaticResource FolderIcon}" Width="20"
                                                                          
                                                                          Height="20"
                                                                          Foreground="{StaticResource MainAlert}"></PathIcon>
                                                            </Button>
                                                        </Grid>
                                                    </Border>
                                                  
                                                    
                                                    <TextBox Text="{Binding CountFileName}"
                                                             Watermark="file name"
                                                             BorderThickness="0" VerticalAlignment="Center" Background="White"
                                                             
                                                    ></TextBox>
                                                </StackPanel>
                                                
                                            </StackPanel>
                                           
                                           
                                        </StackPanel>
                                       
                                    </Grid>
                                    
                                </Border>
                                <!--mark as read -->
                                <Border Background="#3542494C" Padding="7"
                                        IsVisible="{ Binding IsMMRIChoiceSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource Read}" Data="{StaticResource MarkReadIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <TextBlock Text="Mark as read"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource Read}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <ListBox Grid.Row="1"
                                                             ItemsSource="{Binding Folders}"
                                                             Cursor="Hand"
                                                             FontFamily="{StaticResource Roboto}"
                                                             SelectionMode="Multiple"
                                                             BorderBrush="{StaticResource CollectData}"
                                                             BorderThickness="1"
                                                             SelectionChanged="OnSelectionChanged"/>
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:MMRIThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>  
                                <!--Trash -->
                                <Border Background="#3542494C" Padding="7"
                                        IsVisible="{ Binding IsTrashSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource Read}" Data="{StaticResource MarkReadIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <TextBlock Text="Send Message to trash"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource Read}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <ListBox Grid.Row="1"
                                                             ItemsSource="{Binding Folders}"
                                                             Cursor="Hand"
                                                             FontFamily="{StaticResource Roboto}"
                                                             SelectionMode="Multiple"
                                                             BorderBrush="{StaticResource CollectData}"
                                                             BorderThickness="1"
                                                             SelectionChanged="OnSelectionChanged"/>
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:MMRIThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>  
                                <!--Archive messages-->
                                <Border Background="#3578CEBD" Padding="7"
                                        IsVisible="{ Binding IsArchiveChoiceSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource SecondaryGreen}" Data="{StaticResource ArchiveIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <TextBlock Text="archive messages"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource SecondaryGreen}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:ArchiveThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>
                                <!--mark as not spam-->
                                <Border Background="#358093F1" Padding="7"
                                        IsVisible="{ Binding IsReportingChoiceSelected}">
                                            <Grid RowDefinitions="30,Auto">
                                                <DockPanel>
                                                    <PathIcon Width="20" Height="20"    Foreground="{StaticResource Spam}" Data="{StaticResource ReportingIcon}" HorizontalAlignment="Left"></PathIcon>
                                                    <CheckBox Margin="9,0,0,0" Width="20" Height="20"
                                                              Cursor="Hand"
                                                              IsChecked="{Binding MarkMessagesAsNotSpamConfig.PreReportingSettings.IsPreReporting}">
                                                        
                                                    </CheckBox>
                                                    <TextBlock Text="Mark as spam"
                                                               FontFamily="{StaticResource Roboto}"
                                                               HorizontalAlignment="Right"
                                                               Foreground="{StaticResource Spam}"
                                                               FontWeight="Bold"></TextBlock>
                                                </DockPanel>
                                             
                                                <StackPanel Grid.Row="1" Spacing="10">
                                                    <StackPanel Spacing="4">
                                                        <!--contain -->
                                                        <components1:MNSThreashold />
                                                    </StackPanel>    
                                                   
                                                   
                                                </StackPanel>
                                               
                                            </Grid>
                                    
                                </Border>
                            </StackPanel>
                            </ScrollViewer>
                          
                        </Border>
                     </StackPanel>
                    <!--<Border Grid.Row="1" Padding="5">
                        <Button Content="Start" Background="{StaticResource Primary}" Foreground="{StaticResource MainWhite}"
                                HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                Cursor="Hand" Command="{Binding ReadAllEmailsInboxMessagesCommand }">
                            
                        </Button>
                    </Border>-->
                </Grid>
                    </ScrollViewer>
                </Grid>
                
                
                
            </Border>
               
        </Border>

        
        <!--Main Content-->
        <Border Grid.Column="0"
                Padding="3"
                Margin="7"
                CornerRadius="4"
                IsVisible="{Binding !IsLoading , Mode=TwoWay}"
               >
            <Grid ColumnDefinitions="5*,1,2*" 
                  RowDefinitions="40,*"
                  >
                <!--side progress area-->
                <Border  Grid.Row="0" Grid.Column="2"
                         Grid.RowSpan="2"
                         
                        Margin="7,0,0,0"
                        >
                    <Grid RowDefinitions="*,400" >
                        <Border Grid.Row="0"
                                Margin="0,40,0,0"
                               Padding="10,0">
                            <Grid RowDefinitions="60,*">
                                <Border Background="White"
                                        Padding="10"
                                        Margin="0,0,0,10">
                                    <DockPanel >
                                        <TextBlock Text="Processes"
                                                   HorizontalAlignment="Center"
                                                   FontFamily="{StaticResource Roboto}"
                                                   FontWeight="Medium"
                                                   FontSize="20"></TextBlock>
                                    </DockPanel>
                                </Border>
                                <Border Grid.Row="1" Background="#F3F5F7"
                                        
                                >
                                    <DockPanel>
                                        <TabControl  Background="White" >
                                            
                                            <TabItem Header="Normal" FontSize="14" >
                                                <!-- Content for the 'All' section -->
                                                <taskCardDesign:NormalTasks />
                                            </TabItem>

                                          
                                            <TabItem Header="Campaign" FontSize="14" >
                                                    <taskCardDesign:CampaignTasks />
                                               
                                            </TabItem>
                                        </TabControl>

                                    </DockPanel>
                                    
                                    
                                </Border>
                            </Grid>
                        </Border>
                        <StackPanel Grid.Row="1" Margin="20" Spacing="10">
                            <!-- Time input and Add button -->
                                <StackPanel Orientation="Horizontal">
                                    <TextBox Watermark="Enter time (e.g. 13:30)"
                                             Text="{Binding TimeText, UpdateSourceTrigger=PropertyChanged}" />
                                    <Button Content="Set Time" Command="{Binding ParseTimeCommand}" />
                                </StackPanel>
                        
                            <!-- List of scheduled times -->
                            <ListBox ItemsSource="{Binding ScheduledTimes}"
                                     SelectedItem="{Binding  SelectedTimeRemove}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate >
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <TextBlock Text="{Binding}" />
                                           
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <Button Background="#E07A5F" Foreground="AliceBlue" Content="Remove"
                                    Command="{Binding RemoveTimeCommand}"/>
                            <Button Background="#D85531" Foreground="AliceBlue" Content="Clear"
                                    Command="{Binding RemoveTimeAllCommand}"/>
                        </StackPanel>
                    </Grid>
                </Border>
                <Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" Background="{StaticResource LightGrey}" />
                <!--Content-->
                <Border  Grid.RowSpan="2" Grid.Row="0" Grid.Column="0"
                       >
                    <Grid  
                        
                          ColumnDefinitions="*,10,Auto"
                          RowDefinitions="40,*">
                        <!--settings-->
                        <Grid Grid.Row="0"  ColumnDefinitions="Auto,*,Auto">
                            <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="2">
                            <Button Grid.Row="0" Grid.Column="0"
                                    Background="Transparent"
                                    CornerRadius="100"
                                    Click="ToggleSideMenu"
                                    BorderThickness="3"
                                    Cursor="Hand"
                                   
                                    >
                                <Button.Styles>
                                    <Style Selector="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Style>
                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                    <Style Selector="Button:selected /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                </Button.Styles>
                                <PathIcon  Data="{StaticResource GearIcon}" >
                                    <PathIcon.Styles>
                                        <Style Selector="PathIcon">
                                            <Setter Property="Foreground" Value="{StaticResource TentGrey}"/>
                                        </Style>
                                        <Style Selector="PathIcon:pointerover">
                                            <Setter Property="Foreground" Value="{StaticResource MainGreen}" />
                                        </Style>
                                    </PathIcon.Styles>
                                </PathIcon>
                            </Button>
                            <Button Grid.Row="0" Grid.Column="0"
                                    Background="Transparent"
                                    CornerRadius="100"
                                    Command="{Binding ReconnectToApiCommand}"
                                    BorderThickness="3"
                                    Cursor="Hand"
                                    
                                    >
                                <Button.Styles>
                                    <Style Selector="Button">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Style>
                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                    <Style Selector="Button:selected /template/ ContentPresenter">
                                        <Setter Property="Background" Value="Transparent" />
                                    </Style>
                                </Button.Styles>
                                <PathIcon  Data="{StaticResource SyncIcon}" >
                                    <PathIcon.Styles>
                                        <Style Selector="PathIcon">
                                            <Setter Property="Foreground" Value="{StaticResource TentGrey}"/>
                                        </Style>
                                        <Style Selector="PathIcon:pointerover">
                                            <Setter Property="Foreground" Value="{StaticResource MainAlert}" />
                                        </Style>
                                    </PathIcon.Styles>
                                </PathIcon>
                            </Button>
                            </StackPanel>
                       <Grid Grid.Column="1" ColumnDefinitions="*,10,*,10,*">
                             <Border Background="#ffe9e1" CornerRadius="0,0,55,55"
                                     Padding="9">
                                 <Grid RowDefinitions="30,*">
                                     <StackPanel>
                                         <TextBlock Text="Logical Processors" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"
                                                    FontSize="11" HorizontalAlignment="Center"/>
                                         <TextBlock Grid.Row="1" Text="{Binding LogicalProcessorCountDisplay}" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                    FontSize="11" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"/>
                                     </StackPanel>
                                     

                                 </Grid>

                             </Border>
                             <Border Grid.Column="2" Background="#eaefe8" CornerRadius="0,0,55,55"
                                     Padding="9">
                                 <Grid RowDefinitions="30,*">
                                     <StackPanel>
                                         <TextBlock Text="Recommended Batch" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"
                                                    FontSize="11" HorizontalAlignment="Center"/>
                                         <TextBlock Grid.Row="1" Text="{Binding RecommendedBatchSizeDisplay}" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                    FontSize="11" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"/>
                                     </StackPanel>
                                 </Grid>

                             </Border>
                             <Border Grid.Column="4" Background="#f0d7ed" CornerRadius="0,0,55,55"
                                     Padding="9">
                                 <Grid RowDefinitions="30,*">
                                     <StackPanel>
                                         <TextBlock Text="Recommended Number oF processes" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"
                                                    FontSize="11" HorizontalAlignment="Center"/>
                                         <TextBlock Grid.Row="1" Text="{Binding RecommendedMaxDegreeOfParallelismDisplay}" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                    FontSize="11" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"/>
                                     </StackPanel>

                                 </Grid>

                             </Border>
                             
                        </Grid>
                        <StackPanel Grid.Column="2"   Orientation="Horizontal" >
                            <Border BorderThickness="1"
                                    BorderBrush="{StaticResource LightGrey}"
                                    CornerRadius="6"
                                    Height="">
                                <Button HorizontalAlignment="Right"
                                        Background="Transparent"
                                        Theme="{StaticResource CustomBtn}"
                                        Command="{Binding OpenFileUploadPopupCommand}">
                                    <DockPanel>
                                        <PathIcon Data="{StaticResource UploadIcon}"
                                                  Width="14"
                                                  Margin="0,0,12,0"
                                                  Foreground="{StaticResource MainAlert}"/>
                                        <TextBlock Text="upload"
                                                   FontFamily="{StaticResource Roboto}" 
                                                   Foreground="{StaticResource MainAlert}"/>
                                    </DockPanel>
                                </Button>
                            </Border>
                           
                            
                            <Border  Background="{StaticResource MainAlert}"
                                     Margin="20,0,7,0"
                                     Height="34"
                                     Width="34"
                                     CornerRadius="20">
                                <Button 
                                       
                                        Background="Transparent"
                                        x:Name="NotificationElement"
                                        Theme="{StaticResource CustomBtn}"
                                        Command="{Binding OpenNotificationopupCommand}">
                             
                                    <PathIcon Data="{StaticResource NotificationIcon}"
                                              Width="16"
                                           
                                              Foreground="{StaticResource LightGrey}"/>
                               
                                </Button> 
                            </Border>
                           
                        </StackPanel> 
                        </Grid>
      
                        <Grid RowDefinitions="*,*,3*"  Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3">
                            <Border  Padding="10">
                                <Grid ColumnDefinitions="*,20,*,20,*">
                                    
                                    <Border CornerRadius="20" Padding="15" Background="#ffe9e1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid ColumnDefinitions="*,*" >
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding TasksCount , Mode=TwoWay}" FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                                    <Border  VerticalAlignment="Center" Background="{StaticResource SecondaryGreen}" Padding="7" CornerRadius="12" Margin="9,0,0,0">
                                                        <TextBlock Text="{Binding RemainingOpenTasks}" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="White" FontWeight="Black"
                                                                   ></TextBlock>
                                                    </Border>
                                                </StackPanel>
                                                <TextBlock Text="ON GOING" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" >
                                                <Svg Path="/Assets/image/binary-coding.svg"
                                                     Width="100" 
                                                     Height="100" 
                                                     Stretch="Uniform" 
                                                     StretchDirection="Both"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    <Border Grid.Column="2" CornerRadius="20" Padding="15" Background="#f0d7ed" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid ColumnDefinitions="*,*" >
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="3" FontSize="40" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                                    <Border  VerticalAlignment="Center" Background="White" Padding="5" CornerRadius="12" Margin="9,0,0,0">
                                                        <TextBlock Text="27 min" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}" FontWeight="Black"
                                                        ></TextBlock>
                                                    </Border>
                                                </StackPanel>
                                                <TextBlock Text="PENDING" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" >
                                                <Svg Path="/Assets/image/deadline.svg"
                                                     Width="100" 
                                                     Height="100" 
                                                     Stretch="Uniform" 
                                                     StretchDirection="Both"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    <Border Grid.Column="4" CornerRadius="20" Padding="15" Background="#eaefe8" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                        <Grid ColumnDefinitions="*,*" >
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" >
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="4h 30min" FontSize="30" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                                </StackPanel>
                                                <TextBlock Text="Begin at" FontSize="14" FontFamily="{StaticResource Roboto}" Foreground="{StaticResource TextMain}"></TextBlock>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" >
                                                <Svg Path="/Assets/image/clock.svg"
                                                     Width="100" 
                                                     Height="100" 
                                                     Stretch="Uniform" 
                                                     StretchDirection="Both"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    
                                </Grid>
                            </Border>
                           
                            <Border Grid.Row="1" Padding="100,0" >
                                <!--<StackPanel VerticalAlignment="Center"  HorizontalAlignment="Stretch" >
                                    <Border 
                                            BorderBrush="{StaticResource LightGrey}"
                                            CornerRadius="20"
                                            BorderThickness="1"
                                            Padding="4">
                                        <Grid ColumnDefinitions="Auto,*,Auto">
                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent" Command="{Binding OpenCampaignPopupCommand }">
                                                <StackPanel Orientation="Horizontal">
                                                    <PathIcon Width="13" Data="{StaticResource AddIcon}" Foreground="{StaticResource MainGreen}" Margin="0,0,10,0" />
                                                    <TextBlock Text="Add campain" Foreground="{StaticResource MainGreen}" FontFamily="{StaticResource Roboto}"></TextBlock>
                                                </StackPanel>
                                            </Button>
                                        </Grid>
                                    </Border>
                                    <Border  Width="130"  Height="30" BorderBrush="{StaticResource LightGrey}"
                                             Background="{StaticResource MainAlert}"
                                            BorderThickness="1,0,1,1"
                                            CornerRadius="0,0,9,9"> 
                                        <Button Theme="{StaticResource CustomBtn}" Background="Transparent" VerticalAlignment="Top">
                                            <StackPanel Orientation="Horizontal">
                                                <PathIcon Width="11" Data="{StaticResource FlagIcon}" Foreground="{StaticResource LightGrey}" Margin="0,0,10,0" />
                                                <TextBlock Text="view full" Foreground="{StaticResource LightGrey}" FontSize="11" FontFamily="{StaticResource Roboto}"></TextBlock>
                                            </StackPanel>
                                        </Button>
                                    </Border>
                                </StackPanel>-->
                                <Grid Grid.Row="1"
                                     ColumnDefinitions="*,Auto,*"
                                     RowDefinitions="*,20,*,20,*">
                                                   
                                       <StackPanel Orientation="Horizontal" Spacing="20" Grid.Column="1">
                                         
                                           <CheckBox Grid.Column="0" Content="Reporting" 
                                                     Command="{Binding ProcessesCheckedManagerCommand}" 
                                                     CommandParameter="IsReportingSelected"
                                                   
                                                     IsChecked="{Binding SelectedProcessesUi.IsReportingSelected, Mode=TwoWay}"
                                                     Width="200"
                                                     Height="40">
                                                    <CheckBox.Template>
                                                        <ControlTemplate>
                                                            <Border Background="White"
                                                                    CornerRadius="2"
                                                                    Padding="10"
                                                                     BorderBrush="{Binding IsReportingChoiceSelected, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                    BorderThickness="1"
                                                                    >
                                                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Spacing="10">
                                                                    <PathIcon Foreground="#8093F1" Data="{StaticResource ReportingIcon}" Width="20" Height="20" HorizontalAlignment="Center"/>
                                                                    <TextBlock Text="Reporting"  Foreground="{Binding IsReportingChoiceSelected, Converter={StaticResource SelectedForgroundConverter}}" FontFamily="{StaticResource Roboto}" FontWeight="SemiBold"/>
                                                                </StackPanel>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </CheckBox.Template>
                                                </CheckBox>
                                           <CheckBox  Cursor="Hand"  Content="Disappearing"
                                                      Command="{Binding ProcessesCheckedManagerCommand}"
                                                      CommandParameter="TrashMessages"
                                                      IsChecked="{Binding SelectedProcessesUi.IsDeleteSpamSelected}"
                                                      Width="200"
                                                      Height="40">
                                                    <CheckBox.Template>
                                                        <ControlTemplate>
                                                            <Border Background="White"
                                                                    CornerRadius="2"
                                                                    Padding="10"
                                                                    BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                    BorderThickness="1">
                                                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Spacing="10">
                                                                    <PathIcon   Foreground="#EE2F69" Data="{StaticResource DeleteSpamIcon}" Width="20" Height="20" HorizontalAlignment="Center"/>
                                                                   
                                                                    <TextBlock Text="Delete Messages" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}" FontWeight="Bold" 
                                                                        Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                    <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                </StackPanel>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </CheckBox.Template>
                                                </CheckBox>
                                           <CheckBox Cursor="Hand"  Content="Disappearing" 
                                                     Command="{Binding ProcessesCheckedManagerCommand}" 
                                                     CommandParameter="MarkMessagesAsReadFromInbox"
                                                     IsChecked="{Binding  SelectedProcessesUi.IsMMRI}"
                                                     Width="200"
                                                     Height="40">
                                                    <CheckBox.Template>
                                                        <ControlTemplate>
                                                            <Border Background="White"
                                                                    CornerRadius="2"
                                                                    Padding="10"
                                                                    BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                    BorderThickness="1">
                                                                <StackPanel Orientation="Horizontal" Spacing="10">
                                                                    <PathIcon   Foreground="{StaticResource Read}" Data="{StaticResource MarkReadIcon}" Width="20" Height="20"  HorizontalAlignment="Center"/>
                                                                   
                                                                    <TextBlock Text="Read messages" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}" FontWeight="Bold" 
                                                                        Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                    <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                </StackPanel>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </CheckBox.Template>
                                                </CheckBox>
                                          
                                       </StackPanel>
                                       <StackPanel Orientation="Horizontal" Spacing="20" Grid.Row="2"
                                                   Grid.Column="1">
                                               <CheckBox Cursor="Hand"   Content="Reporting" Command="{Binding ProcessesCheckedManagerCommand}" IsChecked="{Binding SelectedProcessesUi.IsGetSpamNumbersSelected}"
                                                              CommandParameter="CollectMessagesCount"
                                                              Width="200"
                                                              Height="40">
                                                        <CheckBox.Template>
                                                            <ControlTemplate>
                                                                <Border Background="White"
                                                                        CornerRadius="2"
                                                                        Padding="10"
                                                                        BorderBrush="{Binding IsCollectDataSelected, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                        BorderThickness="1">
                                                                    <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Spacing="10">
                                                                        <PathIcon Foreground="#C695EF" Data="{StaticResource CollectSpamNumberIcon}" Width="20" Height="20" HorizontalAlignment="Center"/>
                                                                        <TextBlock Text="Collect Data" FontFamily="{StaticResource Roboto}" HorizontalAlignment="Center" FontWeight="Bold" 
                                                                            Foreground="{Binding IsCollectDataSelected, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                        <!--<TextBlock Text="Alert is sent as soon as person appears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                    </StackPanel>
                                                                </Border>
                                                            </ControlTemplate>
                                                        </CheckBox.Template>
                                                    </CheckBox>
                                            <CheckBox Cursor="Hand" Content="Disappearing" 
                                                                  Command="{Binding ProcessesCheckedManagerCommand}" 
                                                                  CommandParameter="ArchiveMessages"
                                                                  IsChecked="{Binding  SelectedProcessesUi.IsArchiveSelected}"
                                                                  Width="200"
                                                                  Height="40">
                                                    <CheckBox.Template>
                                                        <ControlTemplate>
                                                            <Border Background="White"
                                                                    CornerRadius="2"
                                                                    Padding="10"
                                                                    BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                    BorderThickness="1">
                                                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Spacing="10">
                                                                    <PathIcon   Foreground="#78CEBD" Data="{StaticResource ArchiveIcon}" Width="20" Height="20"  HorizontalAlignment="Center"/>
                                                                   
                                                                    <TextBlock Text="Archive messages" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}" FontWeight="Bold" 
                                                                        Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                    <!--<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>-->
                                                                </StackPanel>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </CheckBox.Template>
                                                </CheckBox>
                                            <!--
                                            <CheckBox  Cursor="Hand"  Content="Disappearing" Command="{Binding ProcessesCheckedManagerCommand}" IsChecked="{Binding SelectedProcessesUi.IsFixAfterFinish}"
                                                       Width="420"
                                                       Height="40">
                                                        <CheckBox.Template>
                                                            <ControlTemplate>
                                                                <Border Background="White"
                                                                        CornerRadius="2"
                                                                        Padding="10"
                                                                        BorderBrush="{TemplateBinding IsChecked, Converter={StaticResource SelectedBackgroundConverter}}"
                                                                        BorderThickness="1">
                                                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal" Spacing="10">
                                                                        <PathIcon  Foreground="#D39CB6" Data="{StaticResource FixIcon}" Width="20" Height="20" HorizontalAlignment="Center"/>
                                                                        
                                                                        <TextBlock Text="Fix Errors" HorizontalAlignment="Center" FontFamily="{StaticResource Roboto}"  FontWeight="Bold" 
                                                                            Foreground="{TemplateBinding IsChecked, Converter={StaticResource SelectedForgroundConverter}}"/>
                                                                        ~1~<TextBlock Text="Alert is sent as soon as person disappears." FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center"/>@1@
                                                                    </StackPanel>
                                                                </Border>
                                                            </ControlTemplate>
                                                        </CheckBox.Template>
                                                    </CheckBox>
                                                    -->
                                         
                                       </StackPanel>
                                    <StackPanel Grid.Column="0" Grid.Row="4" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Center" >
                                        <Button  Content="Add campaign" HorizontalAlignment="Center" Background="{StaticResource MainAlert}"  Command="{Binding AddSingleCampaignTaskCommand}"  Foreground="{StaticResource MainWhite}"
                                                 Width="120" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                                 Cursor="Hand" /> 
                                        <Button Content="Start Normal" Background="{StaticResource Primary}" Foreground="{StaticResource MainWhite}"
                                                HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                                Cursor="Hand" Command="{Binding ReadAllEmailsInboxMessagesCommand }"
                                                Width="120">
                            
                                        </Button>
                                    </StackPanel>
                                </Grid>  
                                            
                               
                            </Border>
                                <Border Grid.Row="2" Grid.Column="0"
                                        Background="White"
                                        Margin="10"
                                        BorderBrush="#B8B8B8"
                                        BorderThickness="0"
                                        CornerRadius="15"
                                        Padding="15">
                                    <Grid RowDefinitions="50,*"
                                          ColumnDefinitions="Auto , 10,*">
                                        <Border VerticalAlignment="Stretch">
                                            <StackPanel   HorizontalAlignment="Center" VerticalAlignment="Top" Height="450" Width="300">
                                                <TextBlock >Temporary emails:</TextBlock>
                                                <TextBox Height="450" Width="300" AcceptsReturn="True" TextWrapping="Wrap"
                                                         Watermark="Email"
                                                         Text="{Binding EmailAccountsTemporary, UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"  />
          
                                            </StackPanel> 
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="2" >
                                            <!--<Grid >
                                                <TextBlock
                                                    FontFamily="{StaticResource Roboto}"
                                                    FontSize="17"
                                                    FontWeight="ExtraBold"
                                                    Text="Email Data-Grid"
                                                    Foreground="{StaticResource TextMain}"
                                                    VerticalAlignment="Center"/>
                                                <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center"
                                                           Text="{Binding CountFilter}"
                                                           Foreground="{StaticResource TextMain}"
                                                           FontFamily="{StaticResource Roboto}"
                                                           FontWeight="Bold"
                                                           FontSize="24"></TextBlock>
                                                <Button x:Name="GridFilterButton" DockPanel.Dock="Right"
                                                        Background="{StaticResource MainAlert}"
                                                        Foreground="{StaticResource TentGrey}"
                                                        Width="100"
                                                        Padding="3"
                                                        BorderBrush="#F6F7EB"
                                                        BorderThickness="2"
                                                       VerticalAlignment="Center"
                                                        Command="{Binding ToggleGridFilterPopupCommand}" HorizontalAlignment="Right" >
                                                    <Button.Styles>
                                                        <Style Selector="Button">
                                                            <Setter Property="Background" Value="Transparent" />
                                                        </Style>
                                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                            <Setter Property="Background" Value="{StaticResource MainAlert}" />
                                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                           </Style>
                                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                                            <Setter Property="Background" Value="{StaticResource MainAlert}" />
                                                            <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                        </Style>
                                                    </Button.Styles>
                                                    
                                                    <DockPanel >
                                                        
                                                        <TextBlock Text="Filter"
                                                                   Foreground="#F6F7EB"
                                                                   FontFamily="{StaticResource Roboto}"></TextBlock>
                                                        <PathIcon x:Name="FilterIcon" HorizontalAlignment="Right" Foreground="#F6F7EB" Data="{StaticResource GridPopupIconFilter}"></PathIcon>
                                                    </DockPanel>
                                                  
                                                </Button>

                                                ~1~ Popup that shows when IsPopupOpen is true @1@
                                                <Popup IsLightDismissEnabled="True" 
                                                       Width="350"
                                                       Height="550"
                                                       PlacementTarget="{Binding ElementName=GridFilterButton}" 
                                                       IsOpen="{Binding IsGridPopupOpen, Mode=TwoWay}">
                                                    <Border BorderBrush="#CFD2CD" BorderThickness="1" Background="{StaticResource LightGrey}"
                                                            CornerRadius="15"
                                                            Padding="15"
                                                            Width="350"
                                                            Height="550"
                                                          >
                                                        
                                                        <Grid RowDefinitions="30, 2,2*, 1,*, 1,*,1,*, 1,*, 1,40"
                                                            >
                                                            <TextBlock Text="Filter"
                                                                       FontFamily="{StaticResource Roboto}"
                                                                       Foreground="{StaticResource Primary}"
                                                                       FontWeight="Bold"
                                                                       HorizontalAlignment="Center"/>
                                                            <Border Grid.Row="1" Background="{StaticResource Primary}" />
                                                            <Border Grid.Row="2"
                                                                    Padding="7,10">
                                                                <Grid RowDefinitions="30,*">
                                                                
                                                                    <TextBlock FontFamily="{StaticResource Roboto}"
                                                                               Foreground="{StaticResource Primary}"
                                                                               Text="by Group"/>
                                                                     
                                                                
                                                                    <Border Grid.Row="1" >
                                                                        <ComboBox   HorizontalAlignment="Stretch"
                                                                                   VerticalAlignment="Center" 
                                                                                   PlaceholderText="Group"
                                                                                   Background="{StaticResource MainWhite}"
                                                                                   Foreground="{StaticResource Primary}"
                                                                                   ItemsSource="{Binding Groups}"
                                                                                   SelectedItem="{Binding SelectedEmailGroupFilter}">
                                                                                    
                                                                        </ComboBox>
                                                                    </Border>
                                                                  
                                                                </Grid>
                                                            </Border> 
                                                            <Border Grid.Row="3" Background="{StaticResource Primary}" />
                                                            <Border Grid.Row="5" Background="{StaticResource Primary}" />
                                                            <Border Grid.Row="4"
                                                                    Padding="7,10">
                                                                <Grid RowDefinitions="*">
                                                                
                                                                    
                                                                
                                                                    <Border  Background="{StaticResource MainWhite}">
                                                                        <StackPanel  Orientation="Horizontal" HorizontalAlignment="Center"
                                                                            >
                                                                           
                                                                            <CheckBox   HorizontalAlignment="Stretch"
                                                                                VerticalAlignment="Center" 
                                                                            IsChecked="{Binding IsGetContainSpam}">
                                                                                    
                                                                            </CheckBox>
                                                                            <TextBlock Text="Contain spam" VerticalAlignment="Center" ></TextBlock>
                                                                        </StackPanel>
                                                                        
                                                                    </Border>
                                                                  
                                                                </Grid>
                                                            </Border>
                                                            <Border Grid.Row="6"
                                                                    Padding="7,10">
                                                                <Grid ColumnDefinitions="*,*" RowDefinitions="30,*">
                                                                    <TextBlock Text="Spam Count Range"
                                                                               FontFamily="{StaticResource Roboto}"
                                                                               Foreground="{StaticResource Primary}" 
                                                                               Grid.ColumnSpan="2"/>
                                                                    <StackPanel Orientation="Horizontal" Grid.Row="1">
                                                                        <TextBlock Text="Min:"
                                                                            VerticalAlignment="Center"
                                                                            Margin="0,0,5,0"/>
                                                                        <TextBox Width="50"
                                                                            Text="{Binding SpamCountMin, Mode=TwoWay}"
                                                                            HorizontalAlignment="Left"
                                                                            VerticalAlignment="Center"/>
                                                                        <TextBlock Text="Max:"
                                                                            VerticalAlignment="Center"
                                                                            Margin="10,0,5,0"/>
                                                                        <TextBox Width="50"
                                                                            Text="{Binding SpamCountMax, Mode=TwoWay}"
                                                                            HorizontalAlignment="Left"
                                                                            VerticalAlignment="Center"/>
                                                                    </StackPanel>
                                                                </Grid>
                                                            </Border>
                                                            <Border Grid.Row="12"
                                                                   >
                                                              
                                                                    <DockPanel>
                                                                        <Button Cursor="Hand" HorizontalAlignment="Left" Content="Apply" Command="{Binding FilterTableCommand}">
                                                                            <Button.Styles>
                                                                                <Style Selector="Button">
                                                                                    <Setter Property="Background" Value="{StaticResource Primary}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                                                                </Style>
                                                                            </Button.Styles>

                                                                        </Button>
                                                                        <Button HorizontalAlignment="Right" Content="reset" Command="{Binding ResetFilterTableCommand}" >
                                                                            <Button.Styles>
                                                                                <Style Selector="Button">
                                                                                    <Setter Property="Background" Value="{StaticResource MainRed}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                                                                </Style>
                                                                                <Style Selector="Button:pressed /template/ ContentPresenter">
                                                                                    <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                                                    <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                                                                </Style>
                                                                            </Button.Styles>
                                                                        </Button>
                                                                    </DockPanel>
                                                            </Border>
                                                        </Grid>
                                                    </Border>
                                                </Popup>
                                            </Grid>-->
                                        </Border>
                                        <!--<DataGrid Grid.Row="1" Grid.Column="2"
                                                      ItemsSource="{Binding EmailDiaplysTable ,Mode=TwoWay}" 
                                                      AutoGenerateColumns="False"
                                                      GridLinesVisibility="All"
                                                      BorderThickness="1" BorderBrush="{StaticResource Primary}"
                                                      IsReadOnly="True"
                                                      CanUserReorderColumns="True"
                                            >
                                            <DataGrid.Styles>
                                                <Style Selector="DataGridColumnHeader">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Setter Property="Background" Value="White" />
                                                    <Setter Property="FontFamily" Value="{StaticResource Roboto}"></Setter>
                                                </Style>
                                            </DataGrid.Styles>
                                            <DataGrid.Columns>
                                                <DataGridTextColumn  Header="Id" Foreground="Black" Binding="{Binding Id}" Width="Auto"/>
                                                <DataGridTextColumn  Header="EmailAddress" Foreground="Black" Binding="{Binding EmailAddress}" Width="Auto"/>
                                                <DataGridTextColumn Header="Group" Foreground="Black" Binding="{Binding Group.GroupName}" Width="Auto"/>
                                                <DataGridTextColumn Header="Inbox count" Foreground="Black" Binding="{Binding Stats.InboxCount}" Width="*"/>
                                                <DataGridTextColumn Header="Spam count" Foreground="Black" Binding="{Binding Stats.SpamCount}" Width="*"/>
                                                <DataGridTextColumn Header="last archive" Foreground="Black" Binding="{Binding Stats.LastArchivedCount}" Width="*"/>
                                                <DataGridTextColumn Header="last read" Foreground="Black" Binding="{Binding Stats.LastReadCount}" Width="*"/>
                                                <DataGridTextColumn Header="last reported count" Foreground="Black" Binding="{Binding Stats.LastNotSpamCount}" Width="*"/>
                                            </DataGrid.Columns>
                                        </DataGrid>-->
                                       
                                        
                                    </Grid>
                    
                         </Border>
                           
                        </Grid>
                        <!--<StackPanel Grid.Row="3" Grid.Column="2">
                            <TextBlock Text="Task Messages:" FontWeight="Bold"/>
                            <ListBox ItemsSource="{Binding TaskMessages,Mode=TwoWay}" />

                            <TextBlock Text="Error Messages:" FontWeight="Bold" Margin="0,10,0,0"/>
                            <ListBox ItemsSource="{Binding ErrorMessages}" />
    
                            <Button Content="Start Tasks" Command="{Binding StartTasksCommand}" />
                        </StackPanel>-->
                       
                    </Grid>
                   
            </Border>
                
            
            </Grid>
        </Border>
        
        <!--upload popup-->
        <Border IsVisible="{Binding IsUploadPopupOpen}" 
                Background="LightGray" 
                HorizontalAlignment="Center" 
                BorderThickness="1"
                BorderBrush="{StaticResource LightGrey}"
                VerticalAlignment="Top"
                Margin="0,20,0,0"
                IsEnabled="{Binding IsEnabled , Mode=TwoWay}">
            
            <StackPanel Orientation="Horizontal">
             
                <Border Background="White"  Padding="10"
                        Width="600"
                        Height="500">
                    <Grid RowDefinitions="40,*,40"
                         >
                        <Border>
                            <DockPanel>
                                <TextBlock Text="Upload File" FontFamily="{StaticResource Roboto}"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource TextMain}"
                                           HorizontalAlignment="Center" Margin="0,0,0,20" />
                                
                                <Button Theme="{StaticResource CustomBtn}" HorizontalAlignment="Right"
                                        Command="{Binding CloseFileUploadPopupCommand}"
                                        Width="24"
                                        VerticalAlignment="Top"
                                        Background="Transparent">
                                    
                                    <PathIcon Data="{StaticResource CloseAppIcon}"></PathIcon>
                                </Button>
                            </DockPanel>
                        </Border>
                        <Grid  Grid.Row="1"
                               RowDefinitions="3*,*">
                            
                            <StackPanel>
                                <Grid Margin="20"
                                      DragDrop.AllowDrop="True"
                                      DragDrop.Drop="Border_OnDrop">
                                    <Rectangle StrokeDashArray="4, 2" Stroke="{StaticResource Secondary}" StrokeThickness="2" RadiusX="3" RadiusY="3"  Fill="White"></Rectangle>
                                    <Border BorderBrush="{StaticResource Secondary}"  BorderThickness="0" CornerRadius="5" Padding="20" HorizontalAlignment="Center" VerticalAlignment="Center"
                                            Background="Transparent"
                                           >
                                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <PathIcon Data="{StaticResource FileUploadIcon}" Foreground="{StaticResource MainAlert}" Width="50" Height="50"
                                                      Margin="0,0,0,50"/>
                                            <DockPanel>
                                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{StaticResource TextMain}"
                                                           FontFamily="{StaticResource Roboto}">
                                                    Drag and Drop file here or  
                                                </TextBlock>
                                                <Button Content="Choose file"
                                                        FontFamily="{StaticResource Roboto}"   
                                                        HorizontalContentAlignment="Center"
                                                        Click="ChooseFileButton_Click"
                                                        Foreground="{StaticResource Secondary}" HorizontalAlignment="Center"
                                                        Background="Transparent" BorderBrush="Transparent"
                                                        Cursor="Hand"
                                                        FontWeight="SemiBold"/>
                                            </DockPanel>
                                          
                                          
                                           
                                            
                                        </StackPanel>
                                    </Border>
                                </Grid>
                                
                                <Border></Border>
                                <TextBlock Text="Supported formats: XLS, XLSX , TXT" HorizontalAlignment="Center" FontSize="10"
                                           Foreground="{StaticResource TextMain}"/>
                                
                                <Border Background="{StaticResource LightGrey}"
                                        Margin="0,20,0,0"
                                        CornerRadius="7"
                                        Padding="10"
                                        Height="90">
                                    <StackPanel>
                                        <DockPanel Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="{Binding FileName}"></TextBlock>
                                                <TextBlock >
                                                    <TextBlock Text="{Binding FileSize}"></TextBlock>
                                                    <TextBlock Text=" mb"></TextBlock>
                                                </TextBlock>
                                            </StackPanel>
                                            <Button 
                                                    Theme="{StaticResource CustomBtn}"
                                                    Command="{Binding CancelTaskCommand}"
                                                    CommandParameter="{Binding CancelUploadToken}"
                                                    IsEnabled="{Binding IsUploading}" 
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Top"
                                                    Background="Transparent"
                                                  
                                                >
                                            <PathIcon Data="{StaticResource CloseAppIcon}"
                                                      ></PathIcon>
                                                </Button>
                                        </DockPanel>
                                        <Grid ColumnDefinitions="*,40">
                                            <ProgressBar Minimum="0" 
                                                         Maximum="100" 
                                                         Value="{Binding UploadProgress}" 
                                                         Height="10"
                                                         Background="{StaticResource MainWhite}"
                                                         Foreground="{StaticResource MainGreen}"
                                                         Margin="0,10,0,0"/>
                                            <TextBlock Grid.Column="1" HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Margin="10,0,0,0"> <TextBlock Text="{Binding UploadProgress}"></TextBlock>%</TextBlock>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                
                              
            
                                <!-- Cancel Upload Button -->
                            
                            </StackPanel>
                          
                        </Grid>
                      

                        <Border Grid.Row="2">
                            <Button Content="Done" HorizontalAlignment="Center" Background="{StaticResource Primary}"  Command="{Binding CloseFileUploadPopupCommand}"  Foreground="{StaticResource MainWhite}"
                                    Width="120" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                    Cursor="Hand">
                                    
                            </Button>
                        </Border>
                    </Grid>
                
                </Border>
                    <Border Background="White" 
                            Margin="1,0,0,0"
                            Width="350"
                            Height="500"
                            >
                        <Grid >
                            <Border Grid.RowSpan="5"   IsVisible="{Binding !IsEnabled , Mode=TwoWay}">
                                <li:LoadingIndicator VerticalAlignment="Center" HorizontalAlignment="Center" Width="50" Height="50" IsActive="{Binding !IsEnabled , Mode=TwoWay}"  Mode="Arcs" SpeedRatio="1.2"/>
                            </Border>
                            <Border Padding="12,12,12,0">
                                <Grid RowDefinitions="40,Auto,Auto,Auto,60,Auto,*"  >
                                    <Border>
                                        <TextBlock Text="group selection"
                                                   FontFamily="{StaticResource Roboto}"
                                                   Foreground="{StaticResource TextMain}"
                                                   FontWeight="Medium"
                                                   HorizontalAlignment="Center"
                                                   FontStyle="Oblique"/>
                                    </Border>
                                    <RadioButton  Grid.Row="1" Content="this will provide you with a form to create new group and assign it to the uploaded list of emails"
                                                  Tag="Create a new group"
                                                  GroupName="VisitOption"
                                                  Height="100"
                                                  Command="{Binding SelectNewGroupCommand}"
                                                  IsChecked="{Binding IsNewGroupSelected, Mode=TwoWay}"
                                                  Theme="{StaticResource CustomRadioButtonTheme}" 
                                                  Margin="0,0,0,10">
                                    </RadioButton>
                                     <RadioButton  Grid.Row="2" Content="this will provide you with a list that contain already pre created groups to choose from"
                                                   Tag="select existing"
                                                   GroupName="VisitOption"
                                                   Command="{Binding SelectExistingGroupCommand}"
                                                   IsChecked="{Binding IsExistingGroupSelected, Mode=TwoWay}"
                                                   Theme="{StaticResource CustomRadioButtonTheme}" />  
                                     <RadioButton  Grid.Row="3" Content="selecting this option will provide you with a group drop down to delete a group"
                                                   Tag="select to delete"
                                                   GroupName="VisitOption"
                                                   Command="{Binding SelectDeleteGroupCommand}"
                                                   IsChecked="{Binding IsDeleteGroupSelected, Mode=TwoWay}"
                                                   Theme="{StaticResource CustomRadioButtonTheme}" />
                            
                                    <StackPanel Grid.Row="4" IsVisible="{Binding IsNewGroupSelected}" Orientation="Vertical" Spacing="5">
                                        <TextBox 
                                                 Padding="9"
                                                 BorderBrush="{StaticResource LightGrey}"
                                                 CornerRadius="9"
                                                 UseFloatingWatermark="False"
                                            
                                                 Watermark="Enter new group name"
                                                 FontFamily="{StaticResource Roboto}"
                                                 
                                                 Text="{Binding NewGroupName, Mode=TwoWay}" />  
                                        <TextBox 
                                                 Padding="9"
                                                 BorderBrush="{StaticResource LightGrey}"
                                                 CornerRadius="9"
                                                 UseFloatingWatermark="False"
                                            
                                                 Watermark="Enter RDP IP"
                                                 FontFamily="{StaticResource Roboto}"
                                                 
                                                 Text="{Binding RdpIp, Mode=TwoWay}" />
                                        <Border   Width="140"
                                                  BorderBrush="{StaticResource LightGrey}"
                                                  BorderThickness="0"
                                                  CornerRadius="9"
                                                  Background="{StaticResource MainAlert}">
                                            <Button Content="Create Group"
                                                  
                                                    Background="Transparent"
                                                   Foreground="{StaticResource MainWhite}"
                                                    Theme="{StaticResource CustomBtn}"
                                                    Command="{Binding CreateNewGroupCommand}" />
                                        </Border>
                                      
                                    </StackPanel>
                                
                                    <ComboBox Grid.Row="5" ItemsSource="{Binding Groups,Mode=TwoWay}"
                                              SelectedItem="{Binding SelectedEmailGroup, Mode=TwoWay}"
                                              IsEnabled="{Binding IsExistingGroupSelected}"
                                              IsVisible="{Binding IsExistingGroupSelected}"
                                              PlaceholderText="Select a group">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding GroupName}" />
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                     <StackPanel Grid.Row="5" Orientation="Vertical" HorizontalAlignment="Center"
                                                 IsEnabled="{Binding IsDeleteGroupSelected}"
                                                 IsVisible="{Binding IsDeleteGroupSelected}">
                                         <ComboBox  ItemsSource="{Binding Groups,Mode=TwoWay}"
                                                    SelectedItem="{Binding SelectedEmailGroup, Mode=TwoWay}"
                                                    PlaceholderText="Select a group to delete"
                                                    Padding="3"
                                                    FontFamily="{StaticResource Roboto}">
                                             <ComboBox.ItemTemplate>
                                                 <DataTemplate>
                                                     <TextBlock Text="{Binding GroupName}" />
                                                 </DataTemplate>
                                             </ComboBox.ItemTemplate>
                                         </ComboBox>
                                         
                                         <Button Command="{Binding DeleteGroupCommand}"
                                                 Foreground="White"
                                             HorizontalAlignment="Center" Theme="{StaticResource CustomBtn}" Content="Delete" Background="{StaticResource MainRed}" >
                                             
                                         </Button>
                                     </StackPanel>
                                    

                            <!-- Display selected group details, for demonstration purposes -->
                                     <Border  Grid.Row="6" >
                                         <Border Width="220"
                                                 Height="30"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Bottom"
                                                 Background="{StaticResource Primary}"
                                                 Padding="4"
                                                 CornerRadius="9,9,0,0">
                                             <TextBlock 
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Bottom"
                                                 FontFamily="{StaticResource Roboto}"
                                                 Foreground="{StaticResource MainWhite}"
                                                       >
                                                 <TextBlock Text="Selected Group: "/><TextBlock  Foreground="{Binding SelectedEmailGroup.GroupName, Converter={StaticResource GroupNameToColorConverter}}"  Text="{Binding SelectedEmailGroup.GroupName}"/>
                                             </TextBlock>
                                         </Border>
                                       
                                     </Border>
                          
                        
                                </Grid>
                            </Border>
                           
                        </Grid>
                        
                    </Border>
            </StackPanel>
           
            </Border>
        
            <Popup IsLightDismissEnabled="True" 
                   Width="600"
                   Height="550"
                   
                   PlacementTarget="{Binding ElementName=NotificationElement}" 
                   IsOpen="{Binding IsNotificationOpen, Mode=TwoWay}">
                        <Border BorderBrush="#CFD2CD" BorderThickness="1"  Background="White"
                            CornerRadius="15"
                            Padding="15"
                            Width="550"
                            Height="550"
                        >
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <Border BorderBrush="LightGray" BorderThickness="1" Cursor="Hand" Margin="0,0,0,10" >
                                    <Button Theme="{StaticResource CustomBtn}"
                                            Command="{Binding ClearAllNotificationsCommand}"
                                            Background="White">
                                        <TextBlock Text="Clear All" ></TextBlock>
                                    </Button>
                                </Border>
                                <ScrollViewer Grid.Row="1" >
                                     <ListBox ItemsSource="{Binding NotificationTasks}" Background="White">
                                                <ListBox.Styles>
                                                    <!-- Style for ListBoxItem -->
                                                    <Style Selector="ListBoxItem">
                                                        <Setter Property="Background" Value="Transparent"/>
                                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                                    </Style>
                                                    <!-- Hover effect -->
                                                    <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="Transparent" />
                                                      
                                                    </Style>
                                                    <!-- Selected effect -->
                                                    <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="Transparent" />
                                                    </Style>
                                                </ListBox.Styles>

                                                <ListBox.ItemTemplate>
                                                   <DataTemplate>
                                                       <Border>
                                                           <StackPanel>
                                                               <Border Cursor="Hand" HorizontalAlignment="Center" CornerRadius="5,5,0,0" Background="{StaticResource LightGrey}"  Padding="1"  BoxShadow="0 0 0.5 1 LightGray"
                                                                       PointerPressed="OnTaskIdBorderPointerPressed">
                                                                   <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Text="{Binding AssignedEmails[0].Group.GroupName}" Margin="5" FontSize="12" FontFamily="{StaticResource Roboto}" FontWeight="SemiLight" Foreground="{StaticResource Primary}" />
                                                               </Border>
                                                               <Border CornerRadius="5"
                                                               BorderThickness="1"
                                                               Padding="0"
                                                               BorderBrush="DarkGray"
                                                               Background="White"
                                                       >
                                                            <Grid RowDefinitions="*,4">
                                                                <Border Padding="6,6,6,6">
                                                                    <Grid RowDefinitions="*,25,*">
                                                                         <Grid ColumnDefinitions="*,Auto,*" RowDefinitions="35" Margin="0,0,0,4">
                                                                            <StackPanel Orientation="Horizontal">
                                                                                <Ellipse  VerticalAlignment="Center" Width="10" Height="10" Fill="#027BCE" Margin="0,0,5,0"/>
                                                                                <TextBlock VerticalAlignment="Center" Text="{Binding StartTime}"  FontFamily="{StaticResource Roboto}"  ></TextBlock>
                                                                            </StackPanel>
                                                                             
                                                                             <StackPanel Grid.Column="1"
                                                                                 HorizontalAlignment="Center" Orientation="Horizontal">
                                                                        
                                                                      
                                                                        
                                                                                <!-- Conditionally visible TextBlock for Success Messages -->
                                                                                <Border Margin="0,0,6,0" Width="50" Height="50" Padding="2" BorderBrush="{StaticResource SecondaryGreen}" CornerRadius="3" BorderThickness="0"  IsVisible="{Binding TakInfoType, Converter={StaticResource TaskInfoTypeToVisibilityConverter}}">
                                                                                    <TextBlock VerticalAlignment="Center" Text="{Binding ItemSuccesMessasges.Count}"
                                                                                        Margin="5" FontSize="12" FontFamily="{StaticResource Roboto}" 
                                                                                        FontWeight="SemiBold" Foreground="{StaticResource MainGreen}"
                                                                                        HorizontalAlignment="Center"
                                                                                       />
                                                                                </Border>    
                                                                                <Border Padding="2" Width="50" Height="50" BorderBrush="{StaticResource SecondaryAlert}" CornerRadius="3" BorderThickness="0"  IsVisible="{Binding TakInfoType, Converter={StaticResource TaskInfoTypeToVisibilityConverter}}">
                                                                                    <!-- Conditionally visible TextBlock for Failed Messages -->
                                                                                    <TextBlock Text="{Binding ItemFailedMessasges.Count}"
                                                                                        Margin="5" FontSize="12" FontFamily="{StaticResource Roboto}" 
                                                                                        FontWeight="SemiBold" Foreground="{StaticResource MainAlert}"
                                                                                        HorizontalAlignment="Center"
                                                                                        VerticalAlignment="Center"
                                                                                       />
                                                                                </Border>
                                                                           
                
                                                                          
                                                                            </StackPanel>
                                                                            <Border Grid.Column="2"
                                                                                BorderBrush="{Binding Color}"
                                                                                    BorderThickness="1"
                                                                                    Background="{Binding SoftColor}"
                                                                                    Padding="7"
                                                                                    CornerRadius="15"
                                                                                    HorizontalAlignment="Right">
                                                                                <TextBlock Text="{Binding Name}"  FontSize="13" FontFamily="{StaticResource Roboto}" FontWeight="Medium" Foreground="{Binding Color}"/>
                                                                            </Border>
                                                                        </Grid>
                                                                                    <!--detail button-->
                                                                                    <Grid Grid.Row="2" ColumnDefinitions="*,*,*">
                                                                                        <Border  Width="80"  Height="30" BorderBrush="{StaticResource LightGrey}"
                                                                                            Background="{StaticResource MainAlert}"
                                                                                            
                                                                                            BorderThickness="1,0,1,1"
                                                                                            CornerRadius="0,0,9,9"> 
                                                                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent" VerticalAlignment="Top"
                                                                                                Command="{Binding ToggleViewMoreDetailsCommand}">
                                                                                                <StackPanel Orientation="Horizontal">
                                                                                                    <PathIcon Width="11" Data="{StaticResource FlagIcon}" Foreground="{StaticResource LightGrey}" Margin="0,0,10,0" />
                                                                                                    <TextBlock Text="Details" Foreground="{StaticResource LightGrey}" FontSize="11" FontFamily="{StaticResource Roboto}"></TextBlock>
                                                                                                </StackPanel>
                                                                                            </Button>
                                                                                        </Border>
                                                                                        <Popup IsLightDismissEnabled="True" 
                                                                                            Width="1620"
                                                                                            Height="900"
                                                                                            Placement="Center"
                                                                                            VerticalAlignment="Top"
                                                                                            HorizontalAlignment="Center"
                                                                                            PlacementTarget="{Binding ElementName=MainGrid}" 
                                                                                            IsOpen="{Binding IsMoreDetailNeeded, Mode=TwoWay}">
                                                                                            <components1:TaskDetailPopup />
                                                                                        </Popup> 
                                                                                        
                                                                                                <!--error type-->
                                                                                        <Border Grid.Column="1" Width="80" Height="30" BorderBrush="{StaticResource LightGrey}"
                                                                                                Background="{StaticResource SLightGrey}"

                                                                                                BorderThickness="1,0,1,1"
                                                                                                CornerRadius="0,0,9,9">
                                                                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent"
                                                                                                    VerticalAlignment="Top"
                                                                                                    Command="{Binding ToggleErrorTypeCommand}">
                                                                                                <StackPanel Orientation="Horizontal">
                                                                                                    <PathIcon Width="11" Data="{StaticResource FlagIcon}"
                                                                                                              Foreground="{StaticResource LightGrey}"
                                                                                                              Margin="0,0,10,0" />
                                                                                                    <TextBlock Text="Error"
                                                                                                               Foreground="{StaticResource TextMain}"
                                                                                                               FontSize="11" FontFamily="{StaticResource Roboto}">
                                                                                                    </TextBlock>
                                                                                                </StackPanel>
                                                                                            </Button>
                                                                                        </Border>
                                                                                        <Popup IsLightDismissEnabled="True"
                                                                                               Width="1000"
                                                                                               Height="900"
                                                                                               Placement="Center"
                                                                                               VerticalAlignment="Top"
                                                                                               HorizontalAlignment="Center"
                                                                                               PlacementTarget="{Binding ElementName=MainGrid}"
                                                                                               IsOpen="{Binding IsErrorTypeNeeded, Mode=TwoWay}">
                                                                                            <components1:ErrorTypePopup />
                                                                                        </Popup>
                                                                                        <Border Grid.Column="2" Width="80"  Height="30" BorderBrush="{StaticResource LightGrey}"
                                                                                            Background="{StaticResource MainRed}"
                                                                                            
                                                                                            BorderThickness="1,0,1,1"
                                                                                            CornerRadius="0,0,9,9"> 
                                                                                            <Button Theme="{StaticResource CustomBtn}" Background="Transparent" VerticalAlignment="Top"
                                                                                                Command="{Binding ToggleViewConsoleDetailsCommand}">
                                                                                                <StackPanel Orientation="Horizontal">
                                                                                                    <PathIcon Width="11" Data="{StaticResource FlagIcon}" Foreground="{StaticResource LightGrey}" Margin="0,0,10,0" />
                                                                                                    <TextBlock Text="console" Foreground="{StaticResource LightGrey}" FontSize="11" FontFamily="{StaticResource Roboto}"></TextBlock>
                                                                                                </StackPanel>
                                                                                            </Button>
                                                                                        </Border>
                                                                                        <Popup IsLightDismissEnabled="True" 
                                                                                            Width="1620"
                                                                                            Height="900"
                                                                                            Placement="Center"
                                                                                            VerticalAlignment="Top"
                                                                                            HorizontalAlignment="Center"
                                                                                            PlacementTarget="{Binding ElementName=MainGrid}" 
                                                                                            IsOpen="{Binding IsConsoleNeeded, Mode=TwoWay}">
                                                                                            <components1:ConsoleLog />
                                                                                        </Popup>
                                                                                    </Grid>
                                                                    </Grid>
                                                                </Border>
                                                               
                                                                <Border Grid.Row="1" CornerRadius="0,0,5,5" Background="{Binding Color}"></Border>
                                                            </Grid>
                                                        </Border>
                                                           </StackPanel>
                                                       </Border>
                                                       
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                </ScrollViewer>
                               
                            </Grid>
                            
                           
                             
                        </Border>
            </Popup>
    </Grid>
</UserControl>

