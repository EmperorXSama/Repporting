<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"   d:DesignWidth="1620" d:DesignHeight="900"
             xmlns:li="using:LoadingIndicators.Avalonia"
             xmlns:viewModels="clr-namespace:RepportingApp.ViewModels"
             xmlns:components="clr-namespace:RepportingApp.Views.Components"
             x:Class="RepportingApp.Views.MailBoxPageView"
             x:DataType="viewModels:MailBoxPageViewModel">
    <Grid >
        <Border ZIndex="10000">
            <components:ErrorIndicatorView DataContext="{Binding ErrorIndicator}" /> 
        </Border>
        <Border  ZIndex="10000"   IsVisible="{Binding IsDataLoaded , Mode=TwoWay}">
            <li:LoadingIndicator VerticalAlignment="Center" HorizontalAlignment="Center" Width="50" Height="50" IsActive="{Binding IsDataLoaded , Mode=TwoWay}"  Mode="Arcs" SpeedRatio="1.2"/>
        </Border>
            <Grid
                IsVisible="{Binding !IsDataLoaded , Mode=TwoWay}"
                RowDefinitions="120,30,*,50">
           
                <Border Padding="12" >
                
                    <Grid 
                          ColumnDefinitions="Auto,*,Auto"
                          RowDefinitions="*,Auto">
                        <Border CornerRadius="12" >
                            <TextBlock 
                                FontSize="20"
                                FontWeight="Bold"
                                VerticalAlignment="Center"
                            >
                                <TextBlock Text="Reporto"></TextBlock>
                                <TextBlock  Text="." Foreground="#FFD85F" FontWeight="Black"></TextBlock>
                            </TextBlock>
                       
                        </Border>
                        
                        <Grid  Grid.Row="0" Grid.Column="1"  HorizontalAlignment="Center" 
                               ColumnDefinitions="*,10,*,10,*"
                               RowDefinitions="Auto,40,Auto">
                            <Button  Content="Initialize Mailbox"  Background="#044B7F"    Foreground="{StaticResource MainWhite}"
                                     Width="170" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                     Command="{Binding InitializeMailBoxCommand}"
                                     Cursor="Hand" 
                                     CornerRadius="12,0,0,0"
                                     BorderThickness="0"/>
                            <Button Grid.Row="0" Grid.Column="2" Content="Delete"  Background="#A64253"    Foreground="{StaticResource MainWhite}"
                                    Width="170" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                    Command="{Binding DeleteAliasesCommand}"
                                    Cursor="Hand" 
                                    CornerRadius="12,0,0,0"
                                    BorderThickness="0"/>
                            <CheckBox Grid.Row="1" Grid.Column="2" Content="Delete Extra"    FontFamily="{StaticResource Roboto}" IsChecked="{Binding IsdeleteExtra}" />
                            <Button Grid.Row="0" Grid.Column="4" Content="Clear and populate"  Background="#BA8F95"    Foreground="{StaticResource MainWhite}"
                                    Width="170" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                    Command="{Binding RefreachAndCleanCommand}"
                                    Cursor="Hand" 
                                    CornerRadius="12,0,0,0"
                                    BorderThickness="0"/> 
                        </Grid>
                 
                   <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Horizontal" Height="40" Spacing="10">
                          <Button Name="DropdownButton1"
                                  HorizontalAlignment="Stretch"
                                  Theme="{StaticResource CustomBtn}"
                                  Background="#95190C"
                                  Content="Select Groups"
                                  Foreground="{StaticResource LightGrey}"
                                  Command="{Binding ToggleGroupSelctionMenuOneCommand }"/>
                          <Popup Name="DropdownPopup1"
                                 PlacementTarget="{Binding ElementName=DropdownButton1}"
                                 PlacementMode="Bottom"
                                 IsOpen="{Binding IsGroupSettingsDropdownOpen1, Mode=TwoWay}">

                              <Border BorderBrush="#95190C"
                                      BorderThickness="1"
                                      Background="White" >
                                  <ListBox HorizontalAlignment="Stretch"
                                      VerticalAlignment="Top"
                                      Padding="2"
                                      Background="White"
                                      Foreground="{StaticResource Primary}"
                                      ItemsSource="{Binding Groups}"
                                      SelectionMode="Multiple"
                                      SelectedItems="{Binding SelectedEmailGroupForTask}"
                                      />
                              </Border>
                          </Popup>
                          
                          <StackPanel>
                              <TextBlock Text="thread"></TextBlock>
                              <TextBox Text="{Binding ReportingSettingsValuesDisplay.MailBoxThread}"></TextBox>
                          </StackPanel> 
                          <StackPanel>
                              <TextBlock Text="Custom Name"></TextBlock>
                              <TextBox Text="{Binding CustomName}" Watermark="custom name"></TextBox>
                          </StackPanel> 
                          <StackPanel>
                              <TextBlock Text="Creation Count"></TextBlock>
                              <TextBox Text="{Binding Count}"></TextBox>
                          </StackPanel>
                         
                       
                        
                   </StackPanel>
                    </Grid>
                </Border>
                
                <Border Grid.Row="2" Padding="12" >
                    <StackPanel Spacing="20">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button  Content="Export"  Background="#424B54"    Foreground="{StaticResource MainWhite}"
                                     Width="170" HorizontalContentAlignment="Center" FontFamily="{StaticResource Roboto}" 
                                     Command="{Binding ExportToTxtCommand}"
                                     Cursor="Hand" 
                                     CornerRadius="12,0,0,0"
                                     BorderThickness="0"/>
                            <TextBlock Text="{Binding CountFilter}" FontFamily="{StaticResource Roboto}" FontWeight="Bold"
                                       Foreground="#424B54"
                                       Margin="20,0,20,0">
                                
                            </TextBlock>
                            
                            <Button x:Name="GridFilterButton" DockPanel.Dock="Right"
                                        Background="{StaticResource MainWhite}"
                                        Foreground="#424B54"
                                        Width="170"
                                        CornerRadius="12,0,0,0"
                                        Padding="3"
                                        BorderBrush="#F6F7EB"
                                        BorderThickness="2"
                                        Command="{Binding ToggleGridFilterPopupCommand}" HorizontalAlignment="Right" >
                                    <Button.Styles>
                                        <Style Selector="Button">
                                            <Setter Property="Background" Value="Transparent" />
                                        </Style>
                                        <Style Selector="Button:pointerover /template/ ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                            <Setter Property="Foreground" Value="#424B54" />
                                           </Style>
                                        <Style Selector="Button:pressed /template/ ContentPresenter">
                                            <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                            <Setter Property="Foreground" Value="#424B54" />
                                        </Style>
                                    </Button.Styles>
                                    
                                    <DockPanel >
                                        
                                        <TextBlock Text="Filter"
                                                   Foreground="#424B54"
                                                   FontFamily="{StaticResource Roboto}"></TextBlock>
                                        <PathIcon x:Name="FilterIcon" HorizontalAlignment="Right" Foreground="#F6F7EB" Data="{StaticResource GridPopupIconFilter}"></PathIcon>
                                    </DockPanel>
                                  
                                </Button>
                        </StackPanel>
                        <DataGrid
                            Grid.Row="1" ItemsSource="{Binding EmailsMailboxesDetailsTable ,Mode=TwoWay}" 
                            AutoGenerateColumns="False"
                            HorizontalAlignment="Center"
                            GridLinesVisibility="All"
                            BorderThickness="1" BorderBrush="{StaticResource Primary}"
                            IsReadOnly="True"
                            CanUserReorderColumns="True"
                        >
                            <DataGrid.Styles>
                                <Style Selector="DataGridColumnHeader">
                                    <Setter Property="Foreground" Value="Black" />
                                    <Setter Property="Background" Value="White" />
                                    <Setter Property="FontFamily" Value="{StaticResource Roboto}"></Setter>
                                </Style>
                            </DataGrid.Styles>
                            <DataGrid.Columns>
                                <DataGridTextColumn  Header="EmailAddress" Foreground="Black" Binding="{Binding EmailAddress}" Width="Auto"/>
                                <DataGridTextColumn Header="Mailbox Count" Foreground="Black" Binding="{Binding MailboxesCount}" Width="Auto"/>
                                <DataGridTextColumn Header="Nickname" Foreground="Black" Binding="{Binding NickName}" Width="Auto"/>
                                <DataGridTextColumn Header="Aliasesss" Foreground="Black" Binding="{Binding Aliases}" Width="*"/> <!-- Stretch to available space -->
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                    
                </Border>
                
                <Grid
                    Grid.Row="3" Grid.Column="0" ColumnDefinitions="*,*" Background="LightGray">
                    <TextBox  IsReadOnly="True"
                              Background="Transparent"
                              BorderThickness="0"
                              VerticalAlignment="Center"
                              TextWrapping="Wrap" Foreground="#78290F" Text="{Binding SuccessMessage}"></TextBox>
                    
                </Grid>

            </Grid>
        
          <Popup IsLightDismissEnabled="True" 
                   Width="350"
                   Height="550"
                   PlacementTarget="{Binding ElementName=GridFilterButton}" 
                   IsOpen="{Binding IsGridPopupOpen, Mode=TwoWay}">
                        <Border BorderBrush="#CFD2CD" BorderThickness="1" Background="{StaticResource LightGrey}"
                            CornerRadius="15"
                            Padding="15"
                            Width="350"
                            Height="550"
                          >
                                <Grid RowDefinitions="30, 2,2*, 1,*, 1,*,40"
                            >
                                <TextBlock Text="Filter"
                                           FontFamily="{StaticResource Roboto}"
                                           Foreground="{StaticResource Primary}"
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"/>
                                <Border Grid.Row="1" Background="{StaticResource Primary}" />
                                <Border Grid.Row="2"
                                        Padding="7,10">
                                    <Grid RowDefinitions="30,*">
                                    
                                        <TextBlock FontFamily="{StaticResource Roboto}"
                                                   Foreground="{StaticResource Primary}"
                                                   Text="by Group"/>
                                         
                                    
                                        <Border Grid.Row="1" >
                                            <ComboBox   HorizontalAlignment="Stretch"
                                                       VerticalAlignment="Center" 
                                                       PlaceholderText="Group"
                                                       Background="{StaticResource MainWhite}"
                                                       Foreground="{StaticResource Primary}"
                                                       ItemsSource="{Binding Groups}"
                                                       SelectedItem="{Binding SelectedEmailGroup}">
                                                        
                                            </ComboBox>
                                        </Border>
                                      
                                    </Grid>
                                </Border>
                                
                                <Border Grid.Row="4"
                                        Padding="7,10">
                                    <Grid RowDefinitions="30,*">
                                                        
                                        <Border >
                                            <TextBlock FontFamily="{StaticResource Roboto}"
                                                       Foreground="{StaticResource Primary}"
                                                       Text="Alias number"
                                                                 
                                            />
                                        </Border>
                                                       
                                               
                                        <Border Grid.Row="1" >
                                            <TextBox Height="30"
                                                     Background="{StaticResource MainWhite}"
                                                     Foreground="{StaticResource Primary}"
                                                     BorderThickness="0"
                                                     Watermark="alias number"
                                                     Padding="6"
                                                     Text="{Binding AliasCountFilter, Mode=TwoWay}"></TextBox>
                                        </Border>
                                                  
                                    </Grid>
                                </Border>
                                <Border Grid.Row="3" Background="{StaticResource Primary}" />
                                
                                <Border Grid.Row="5" Background="{StaticResource Primary}" />
                                <Border Grid.Row="6"
                                       >
                                  
                                        <DockPanel>
                                            <Button Cursor="Hand" HorizontalAlignment="Left" Content="Apply" Command="{Binding FilterTableCommand}">
                                                <Button.Styles>
                                                    <Style Selector="Button">
                                                        <Setter Property="Background" Value="{StaticResource Primary}" />
                                                        <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                    </Style>
                                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                        <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                                    </Style>
                                                    <Style Selector="Button:pressed /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                        <Setter Property="Foreground" Value="{StaticResource Secondary}" />
                                                    </Style>
                                                </Button.Styles>

                                            </Button>
                                            <Button HorizontalAlignment="Right" Content="reset" Command="{Binding ResetFilterTableCommand}" >
                                                <Button.Styles>
                                                    <Style Selector="Button">
                                                        <Setter Property="Background" Value="{StaticResource MainRed}" />
                                                        <Setter Property="Foreground" Value="{StaticResource MainWhite}" />
                                                    </Style>
                                                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                        <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                                    </Style>
                                                    <Style Selector="Button:pressed /template/ ContentPresenter">
                                                        <Setter Property="Background" Value="{StaticResource MainWhite}" />
                                                        <Setter Property="Foreground" Value="{StaticResource MainRed}" />
                                                    </Style>
                                                </Button.Styles>
                                            </Button>
                                        </DockPanel>
                                </Border>
                        </Grid>
                    </Border>
                </Popup>
    </Grid>
            
                    
   
</UserControl>
